<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
   <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      font-family: Arial, sans-serif;
    }

    header {
      padding: 1rem;
      text-align: center;
    }

    main {
      flex: 1;
      padding: 2rem;

    }

    footer {
      background: #222;
      color:aliceblue;
      text-align: center;
      padding: 1rem;
      z-index:99;
    }
  </style>
</head>
<body>
  <header>
    <style>
     @import url("https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap");

    :root {
      --color-black: hsl(0, 0%, 10%);
      --color-darks: hsl(0, 0%, 25%);
      --color-greys: hsl(0, 0%, 60%);
      --color-light: hsl(0, 0%, 95%);
      --color-white: hsl(0, 0%, 100%);
      --color-blue-100: hsl(217, 91%, 65%);
      --color-blue-200: hsl(221, 83%, 55%);
      --color-blue-300: hsl(224, 76%, 45%);
      --shadow-medium: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      
      background-color: var(--color-white);
      color: var(--color-black);
    }

   .menu a {
      text-decoration: none;
      color: inherit;
    }

    header.header {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--color-white);
      box-shadow: var(--shadow-medium);
      z-index: 99;
    }

    .nav-container {
      max-width: 1600px;
      font-family: 'Rubik', sans-serif;
      margin: auto;
      padding: 0 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 4rem;
    }

    .brand {
      font-size: 1.6rem;
      font-weight: 600;
      color: var(--color-blue-200);
      text-transform: uppercase;
    }

    .burger {
      display: block;
      width: 1.6rem;
      cursor: pointer;
    }

    .burger-line {
      width: 100%;
      height: 2px;
      background: var(--color-black);
      margin: 5px 0;
      border-radius: 10px;
    }

    .menu {
      position: fixed;
      top: 0;
      left: -100%;
      width: 80%;
      height: 100vh;
      background: var(--color-white);
      box-shadow: var(--shadow-medium);
      transition: 0.3s ease;
      z-index: 11;
    }

    .menu.is-active {
      left: 0;
    }

    .menu-inner {
      padding: 5rem 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .menu-link {
      font-size: 1.1rem;
      font-weight: 500;
      text-transform: uppercase;
      color: var(--color-black);
    }

    .menu-link:hover {
      color: var(--color-blue-200);
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      background: rgba(0, 0, 0, 0.6);
      width: 100%;
      height: 100%;
      opacity: 0;
      visibility: hidden;
      z-index: 10;
      transition: 0.3s ease;
    }

    .overlay.is-active {
      opacity: 1;
      visibility: visible;
    }

    .search-toggle {
      font-size: 1.5rem;
      cursor: pointer;
    }

    .search-block {
      position: fixed;
      top: 0;
      right: -100%;
      width: 100%;
      height: 100vh;
      background: var(--color-white);
      z-index: 99;
      transition: 0.3s ease;
      padding: 1.5rem;
    }

    .search-block.is-active {
      right: 0;
    }
.search-form-container {
  max-width: 600px;
  margin: auto;
  
}
    .search-form {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem 1.25rem;
      border: none;
      border-radius: 5px;
      background: var(--color-light);
      font-size: 1rem;
    }

    .search-cancel {
      font-size: 1.5rem;
      cursor: pointer;
    }
.search-block {
  position: fixed;
  top: 0;
  right: -100%;  
  width: 100%;
  height: 100vh;
  background: white;
  z-index: 12;
  transition: 0.3s ease;
  padding: 0.8rem;
}

.search-block.is-active {
  right: 0;  
}
.search-form {
  display: flex;
  gap: 10px;
  align-items: center;
  max-width: 100%;
  flex-wrap: wrap;
}

.search-form {
  display: flex;
  align-items: center;
  gap: 10px;
  max-width: 600px;
  margin: 0 auto;
  font-family: Arial, sans-serif;
}

.back-btn {
  background: none;
  border: none;
  font-size: 22px;
  color: #333;
  cursor: pointer;
  transition: color 0.2s;
}

.back-btn:hover {
  color: #007BFF;
}

.search-input-wrapper {
  position: relative;
  flex: 1;
}

.search-icon {
  position: absolute;
  left: 12px;
  font-size: 18px;
  color: #aaa;
  top: 50%;
  transform: translateY(-50%);
}

.search-input {
  width: 100%;
  padding: 10px 36px 10px 36px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 16px;
  transition: all 0.3s ease;
}

.search-input:focus {
  border-color: #007BFF;
  box-shadow: 0 0 0 2px #007bff33;
  outline: none;
}

.clear-input {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  color: #999;
  font-size: 16px;
  display: none;
}

.clear-input:hover {
  color: #ff4d4d;
}

.search-btn {
  background-color: #007BFF;
  color: white;
  padding: 10px 14px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  display: flex;
  align-items: center;
  cursor: pointer;
  transition: background 0.3s;
}

.search-btn:hover {
  background-color: #0056b3;
}

    #search-results {
      position: relative;
      margin-top: 2px;
      font-size: 14px;
      color: #333;
      overflow: auto;
      max-height: 500px;
    }
    #search-results div {
    border: 1px solid #333;
    padding: 2px;
  border-bottom: 1px solid #eee;
}
  a:link {text-decoration: none;}
  a:hover { color:#367404}
    mark {
        background-color: yellow;
      color: black;
      padding: 0 2px;
      border-radius: 3px;
    }
    h3 {

    display: block;
    font-size: 1.17em;
    margin-block-start: 0.2rem;
    margin-block-end: 0.1rem;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    font-weight: bold;
    unicode-bidi: isolate;
}
p {
    display: block;
    margin-block-start: 0.2rem;
    margin-block-end: 0.1rem;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    unicode-bidi: isolate;
}

.logo-img {
  margin-top:5px;
  width: 200px;}

    @media (min-width: 768px) {
      .burger {
        display: none;
      }

      .menu {
        position: static;
        height: auto;
        width: auto;
        display: flex;
        box-shadow: none;
        background: none;
        left: auto;
      }

      .menu-inner {
        flex-direction: row;
        padding: 0;
        gap: 2rem;
      }

      .overlay {
        display: none;
      }
    }
    
</style>




<head>
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
</head>

  <header class="header">
    <div class="nav-container">
      <div class="burger" id="burger">
        <div class="burger-line"></div>
        <div class="burger-line"></div>
        <div class="burger-line"></div> 
      </div>
       <a href="/" class="brand">
        <img class="logo-img" src="/logo/logo-1080x200.png" alt="GAJAB TOOLS"  loading="lazy" />
      </a>
       
      <div class="menu" id="menu">
        <ul class="menu-inner">
          <li><a href="#" onclick="setPreferredHome()" class="menu-link">Switch</a></li>
          <li><a href="/" class="menu-link"> Home</a></li>
          <li> <a href="/pdf-forms/" class="menu-link">Forms</a></li> 
          <li><a href="/baner-poster-update/" class="menu-link">Poster</a></li>
          <li><a href="/last-date/" class="menu-link">Lastdate</a></li>
          <li><a href="/latest-jobs/" class="menu-link">Latest Jobs</a></li>
        </ul>
      </div>
     <i class="bx bx-search search-toggle" id="searchToggle"></i>


<div class="search-block" id="searchBlock">
 <div class="search-form-container">
    <form class="search-form" onsubmit="handleSearch(event)" method="post" action="" name="search-form">
    <input type="hidden" name="TimeStamp" class="Advance" id="timestamp-field">
    <input type="hidden" name="use-in" class="advnce" value="TopSearch">
  <i class="bx bx-arrow-back search-cancel" class="back-btn" id="searchCancel"></i>

  <div class="search-input-wrapper">
    <i class="bx bx-search search-icon"></i>
    <input id="search-query" class="search-input" name="Search" type="text" placeholder="Search..." />
    <span class="clear-input" id="clearInputBtn">‚úï</span>
  </div>

  <button type="submit" class="search-btn">
    <i class="bx bx-search"></i>
  </button>
    </form>
    <div id="search-results"></div>
    <div id="recent-searches"></div>
    <iframe id="search-iframe" src="/menu" style="display: none; height: 600px; width: 100%; border: none;" name="menu"></iframe>
  </div>
</div>
</div>
  </header>


<div id="installBtn" style="display: none;">
  <img width="30px" src="https://www.yojnaportal.com/logo/logo-100x100.png" alt="App Icon">
  Yojna Portal App <span style="color:blue; font-weight:700;">Install</span>
  <button id="closeInstallBtn" onclick="document.getElementById('installBtn').style.display='none'">‚ùå</button>
</div>

  <div class="overlay" id="overlay"></div>
<script>
function setPreferredHome() {
  const currentPref = localStorage.getItem("preferredHome");
  if (currentPref === "homepage") {
    localStorage.removeItem("preferredHome");
    window.location.href = '/';
  } else {
    localStorage.setItem("preferredHome", "homepage");
    window.location.href = '/homepage/';
  }
}
</script>

 

  </header>
  <main>
    
  <h1>Typing-Speed-Tests</h1>
  
  
    <h2><a href="/typing-speed-test/english/10m/">Typing test Speed English -10 Minit</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:16px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="2" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [

`Success does not come overnight, and typing speed is no different. Every master once started as a beginner, pressing one key at a time. Do not compare your speed with others, because everyone has their own journey. What matters is your effort today.
When you practice, you are not just learning typing, you are training your brain to focus and your fingers to move with confidence. Small daily practice is better than long but irregular effort. Even ten minutes a day will change your skills in a few months. Remember, the habit you build today will give you lifelong benefit.
Believe in yourself, stay motivated, and let each keystroke be a step toward your success.`,
`"The Power of Consistency"
Success is not the result of one big action, but the outcome of countless small efforts made every single day. Many people believe that greatness requires extraordinary talent or luck, but the truth is much simpler: consistency. When you choose to work steadily toward your goals, even in small steps, you create momentum. That momentum slowly builds habits, and habits shape your destiny.
Think of water dripping on a stone. A single drop does nothing, but when drops fall again and again, they carve the stone itself. In the same way, your daily discipline‚Äîstudying a little, practicing regularly, waking up on time, or exercising each day‚Äîmay seem small, but over months and years it creates results beyond imagination.
There will be days when motivation feels weak, when you want to quit or take a break. That is the exact moment when consistency matters the most. Showing up even when it‚Äôs difficult strengthens not just your skills, but also your character. It teaches patience, perseverance, and self-belief.
Remember this: talent can shine for a while, but discipline and consistency win in the long run. Keep moving, keep working, and trust the process. One day, you will look back and realize that your small daily efforts have built a mountain of success.`,
`Typing practice is like building a house. Each word you type is a brick, and every session makes the structure stronger. At first, it looks like nothing is changing, but after a while, the results are visible. The wall becomes higher and stronger. Similarly, your typing speed may not grow in one day, but with patience and daily work, it will become solid. Do not fear mistakes. Mistakes are not failure; they are lessons. Each error guides you to the right path.
Keep typing, keep learning, and your future self will thank you for the effort you put in today.`,
`In this digital world, typing is a superpower. It saves time, increases productivity, and makes communication faster.
When you type with speed and accuracy, you get more freedom to focus on ideas rather than the keyboard. The key to improvement is consistency. Just like athletes train daily to stay fit, your fingers need daily practice to stay sharp. You may type slowly now, but if you do not quit, improvement is guaranteed.
Think about the confidence you will feel when you can type without looking at the keys. That day will come soon if you keep practicing today.`,
`Patience is your best friend in typing practice. Many learners give up too quickly because they expect fast results.
But real progress comes slowly and steadily. Imagine planting a seed today. You water it daily, and after some time it becomes a strong tree. Typing practice works the same way.
Every word is a drop of water, and every session adds strength. One day, your typing skills will be like a strong tree giving you shade in the form of confidence and productivity. Do not stop, because every small step counts.`,
`Every challenge in typing is an opportunity to grow. When you see a difficult word or a tricky sentence, take it as a chance to improve.
Do not avoid challenges, embrace them. The harder the passage, the more it trains your fingers and brain. With practice, what feels hard today will feel easy tomorrow.
Life works the same way. Challenges make you stronger. Stay motivated, stay focused, and remember that your growth comes from pushing yourself beyond comfort.`,
`Discipline always beats motivation. You may not feel motivated every day to practice typing, but discipline will push you forward.
Create a routine and stick to it. Even when you do not feel like practicing, do it for at least five minutes. Those small moments add up.
Success is not about one big effort; it is about hundreds of small efforts done daily. Train your discipline, and your fingers will follow. Soon you will see the power of persistence in your typing speed and accuracy.`,
`Typing is more than just pressing keys; it is about building confidence.
Imagine sitting in an exam, writing an assignment, or working in an office where speed matters. Fast typing gives you an advantage in every field.
The best part is, this skill stays with you for life. Once you master it, it never leaves you. So do not waste time doubting yourself.
Start now, practice daily, and watch how a simple habit can create lifelong success.`,
`Remember that every expert was once a beginner who refused to give up. The only difference between you and a fast typist is practice.
They practiced more, and so they became better. You too can achieve that speed if you keep going.
Do not rush. Enjoy the process. Feel the rhythm of your fingers, enjoy the sound of the keys, and let typing become a fun game instead of a boring task. When learning becomes fun, improvement becomes natural.`,
`Stay positive while practicing typing. Negative thoughts like "I am too slow" or "I cannot improve" will only block your progress. Replace them with positive thoughts such as "I am improving every day" and "With practice, I will be fast." Your mind controls your body.
If your mind believes in success, your fingers will follow. Motivation comes from within.
So encourage yourself, cheer for yourself, and type with confidence. You are capable of more than you think.`,
`Your future self is waiting for the efforts you make today. Think about the opportunities that will come when you can type with speed and accuracy.
You will save time, finish work faster, and feel confident in every situation. All of this is possible if you stay consistent.
The keyboard in front of you is not just a tool, it is a bridge to your success. Practice every day, trust the process, and remember: great skills are built with small daily actions. Keep typing, keep growing, and keep believing in yourself.`

];


// üîπ Global Variables
let textToType, chars;
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = textToType.split("");
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
  timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText(typedChars) {
  if (typingMode === "word") {
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ") ? typedWords.length : typedWords.length - 1;
    textDiv.innerHTML = words.map((word, i) => {
      let cls = "";
      if (typedWords[i] == null) cls = "";
      else if (typedWords[i] === word) cls = "correct";
      else cls = "incorrect";
      return i === currentWordIndex
        ? `<span class="active">${word}</span>`
        : `<span class="${cls}">${word}</span>`;
    }).join(" ");
  } else {
    textDiv.innerHTML = chars.map((ch, i) => {
      let typed = typedChars[i];
      let cls = "";
      if (typed == null) cls = "";
      else if (typed === ch) cls = "correct";
      else cls = "incorrect";
      let displayChar = ch === "\n" ? "‚Ü≤\n" : ch;
      if (i === typedChars.length) {
        return `<span id="activeChar" class="active">${displayChar}</span>`;
      } else {
        return `<span class="${cls}">${displayChar}</span>`;
      }
    }).join("");
  }
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}

// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedChars = val.split("");

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText(typedChars);
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedChars.forEach((ch, i) => {
      if (ch === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }
});

// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi-copy/10m/">Typing test Speed Hindi Tradition -10 Minit</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø 
‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á 
‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï
‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï 
‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø
‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§
‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á 
‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø
‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á
‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï
‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á 
‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`
];

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l1/">Typing test Speed Hindi Tradition -10 Minit</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø ‡§ö‡•ã‡§∞‡§ø ‡§§‡•ã‡§∞‡§ø 
‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á ‡§ï‡§∞‡§§‡•á ‡§§‡§∞‡§§‡•á 
‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï ‡§ï‡§∞‡•ç‡§§‡§æ ‡§∞‡•ã‡§ö‡§ï
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§ö‡§ï
‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï ‡§∞‡§ø‡§ö ‡§ö‡•á‡§§‡§ï 
‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã ‡§ï‡§∞‡•ç‡§ï ‡§§‡§ø‡§ï‡•ç‡§ï‡•ã
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø
‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§ ‡§§‡§∞‡§ø‡§ï ‡§ï‡§ø‡§∞‡§§
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§ ‡§§‡§∞‡§ø‡§ï ‡§∞‡§ï‡•ç‡§§
‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á ‡§∞‡•ã‡§§‡•á ‡§§‡•ã‡§§‡•á 
‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•ã‡§ï‡§∞ ‡§ö‡§ï‡•ç‡§ï‡§ø
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø ‡§ï‡•ã‡§ö ‡§∞‡•ã‡§§‡§ø
‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á ‡§§‡•ã‡§∞‡§ï‡•á ‡§ö‡•ã‡§∞‡§ï‡•á
‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï ‡§§‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ç‡§∞‡§§‡§ï
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`,

`‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã ‡§ö‡•ã‡§§‡•á‡§ï‡•ç‡§∞‡§ø ‡§∞‡§ø‡§ï‡•ç‡§§‡•á‡§ö‡•ã
‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï ‡§ö‡§ø‡§§‡•ç‡§§‡§∞ ‡§ï‡§∞‡•ç‡§ï
‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á ‡§§‡•ã‡§§‡§∞ ‡§ö‡•ã‡§§‡§ï‡•á 
‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø ‡§ï‡•ã‡§ö‡§ø ‡§∞‡•ã‡§ö‡§ø
‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã ‡§∞‡§§‡§ø ‡§ö‡§ï‡•ç‡§ï‡§ø ‡§ö‡•á‡§ï ‡§ï‡§∞‡•ã`
];

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi-copy/l2/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞
‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞
‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø
‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø
‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü
‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞
‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞
‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞
‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`
]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l10/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [

`‡§ã‡§É)(‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑‡§∂‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§∞‡•ç‡§ú‡•ç‡§û‡§§‡•ç‡§∞‡§ú‡•ç‡§û ‡§ã‡§É)(‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ï‡•ç‡§∑ ‡§ç‡•Ö‡•ç‡§∞‡§∞‡•ç‡§ú‡•ç‡§û‡§§‡•ç‡§∞‡§ú‡•ç‡§û
‡§ã‡§∑‡§ø, ‡§Æ‡•Å‡§®‡§ø ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§∂‡•Ä‡§∞‡•ç‡§µ‡§æ‡§¶ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§∂‡•ç‡§∞‡§¶‡•ç‡§ß‡§æ: ‡§∏‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§∏‡§´‡§≤ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø (‡§Ø‡•ã‡§¶‡•ç‡§ß‡§æ) ‡§∏‡§æ‡§π‡§∏ ‡§ï‡§æ ‡§™‡§∞‡§ø‡§ö‡§Ø ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ú‡•ç‡§û‡§æ‡§®‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø, ‡§∏‡§§‡•ç‡§Ø ‡§ï‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§ö‡•Å‡§®‡§§‡§æ ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£ ‡§Æ‡•á‡§Ç (‡§§‡•Ä‡§®) ‡§≠‡•Å‡§ú‡§æ‡§è‡§Å ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§
‡§ã‡§§‡•Å ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®, ‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø ‡§ï‡•ã ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï: ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§ï‡•ç‡§∑‡§∞-‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§∞‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ï‡•ç‡§∑‡§Æ‡§æ, ‡§Æ‡§π‡§æ‡§® ‡§ó‡•Å‡§£ ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡•á ‡§Ö‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡§æ ‡§®‡§æ‡§∂ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§µ‡§£ (‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏) ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§¨‡§®‡•Ä ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•Å‡§ß‡§æ‡§∞: ‡§≤‡•á‡§ñ‡§® ‡§ï‡•ã ‡§¨‡•á‡§π‡§§‡§∞ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à‡•§`,

`‡§ã‡§É)(‡§∂‡•ç‡§∞‡§ú‡•ç‡§û‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§∂‡•ç‡§∞‡§ú‡•ç‡§û‡§§‡•ç‡§∞ ‡§ã‡§É)(‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§∂‡•ç‡§∞‡§ú‡•ç‡§û ‡§ç‡•Ö‡•ç‡§∞‡§ú‡•ç‡§û‡§∂‡•ç‡§∞
‡§ã‡§∑‡§ø ‡§®‡•á ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§® ‡§ï‡§ø‡§Ø‡§æ‡•§
‡§∂‡•ç‡§∞‡§¶‡•ç‡§ß‡§æ‡§≤‡•Å, ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø ‡§á‡§§‡§ø‡§π‡§æ‡§∏: ‡§µ‡•Ä‡§∞‡§§‡§æ ‡§∏‡•á ‡§≠‡§∞‡§æ ‡§π‡•à‡•§
‡§ú‡•ç‡§û‡§æ‡§®‡•Ä ‡§ó‡•Å‡§∞‡•Å (‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§ï) ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£ ‡§ó‡§£‡§ø‡§§ ‡§ï‡•Ä ‡§Ü‡§ï‡•É‡§§‡§ø ‡§π‡•à‡•§
‡§ã‡§§‡•Å ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞, ‡§ñ‡•á‡§§‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ: ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§æ ‡§Ü‡§ß‡§æ‡§∞ ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§∏‡•á (‡§∏‡§Ç‡§¨‡§Ç‡§ß) ‡§Æ‡§ß‡•Å‡§∞ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ú‡•ç‡§û‡§æ‡§®, ‡§Æ‡§® ‡§ï‡•ã ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§µ‡§£ ‡§î‡§∞ ‡§Æ‡§®‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•á ‡§∏‡•Ä‡§ñ: ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à‡•§`,

`‡§ã‡§É)(‡§§‡•ç‡§∞‡§ú‡•ç‡§û‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑ ‡§ç‡•Ö‡•ç‡§∞‡§ï‡•ç‡§∑‡§∂‡•ç‡§∞‡§ú‡•ç‡§û ‡§ã‡§É)(‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑‡§ú‡•ç‡§û‡§§‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§§‡•ç‡§∞‡§ú‡•ç‡§û‡§∂‡•ç‡§∞
‡§ã‡§∑‡§ø ‡§ï‡§æ ‡§ú‡•Ä‡§µ‡§® ‡§∏‡§æ‡§¶‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§¶‡•ç‡§ß‡§æ ‡§∏‡•á (‡§™‡§¢‡§º‡§æ‡§à) ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§
‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø ‡§Ø‡•ã‡§¶‡•ç‡§ß‡§æ, ‡§®‡§ø‡§∞‡•ç‡§≠‡•Ä‡§ï ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ú‡•ç‡§û‡§æ‡§®‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§Ö‡§π‡§Ç‡§ï‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§
‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£ ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§£ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ã‡§§‡•Å ‡§ö‡§ï‡•ç‡§∞: ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§ö‡§≤‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§ú‡•ç‡§û‡§æ‡§® ‡§¨‡§æ‡§Å‡§ü‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§∏‡•á, ‡§∂‡§§‡•ç‡§∞‡•Å ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§¨‡§®‡§§‡§æ ‡§π‡•à‡•§
‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§ß‡§® ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§µ‡§£ ‡§∂‡§ï‡•ç‡§§‡§ø ‡§¨‡§¢‡§º‡§æ‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§
‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡§∞‡§ø‡§Ø‡§æ‡§≤‡•Ä ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•Å‡§ß‡§æ‡§∞ (‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏) ‡§∏‡•á ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§`,

`‡§ã‡§É)(‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑‡§ú‡•ç‡§û‡§§‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§§‡•ç‡§∞‡§∂‡•ç‡§∞‡§ú‡•ç‡§û ‡§ã‡§É)(‡§ú‡•ç‡§û‡§§‡•ç‡§∞‡§ï‡•ç‡§∑‡§∂‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑
‡§ã‡§∑‡§ø ‡§∏‡§Æ‡§æ‡§ú ‡§ï‡•ã ‡§¶‡§ø‡§∂‡§æ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§∂‡•ç‡§∞‡§¶‡•ç‡§ß‡§æ ‡§∏‡•á ‡§∏‡•á‡§µ‡§æ ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§
‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø ‡§ß‡§∞‡•ç‡§Æ: ‡§ï‡•Ä ‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ú‡•ç‡§û‡§æ‡§®‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø (‡§∂‡§æ‡§Ç‡§§) ‡§∞‡§π‡§§‡§æ ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£ ‡§∏‡§∞‡§≤ ‡§Ü‡§ï‡•É‡§§‡§ø ‡§π‡•à‡•§
‡§ã‡§§‡•Å ‡§¨‡§¶‡§≤‡§®‡•á ‡§∏‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§¨‡§¶‡§≤‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ: ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•ã ‡§∏‡•Å‡§ß‡§æ‡§∞‡§§‡•Ä ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§∏‡•á ‡§Æ‡§® ‡§π‡§≤‡•ç‡§ï‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡•á ‡§Ü‡§§‡•ç‡§Æ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§¨‡§¢‡§º‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§µ‡§£ ‡§∏‡•á ‡§∏‡•ç‡§Æ‡§∞‡§£ ‡§∂‡§ï‡•ç‡§§‡§ø ‡§¨‡§¢‡§º‡§§‡•Ä ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§≤‡•ã‡§ó ‡§∏‡§π‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§™‡§π‡§ö‡§æ‡§®‡§®‡§æ (‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï) ‡§π‡•à‡•§`,

`‡§ã‡§É)(‡§ú‡•ç‡§û‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§∂‡•ç‡§∞‡§§‡•ç‡§∞‡§ú‡•ç‡§û ‡§ã‡§É)(‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ú‡•ç‡§û‡§∂‡•ç‡§∞ ‡§ç‡•Ö‡•ç‡§∞‡§§‡•ç‡§∞‡§∂‡•ç‡§∞‡§ï‡•ç‡§∑
‡§ã‡§∑‡§ø ‡§§‡§™‡§∏‡•ç‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§≤‡•Ä‡§® ‡§∞‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§∂‡•ç‡§∞‡§¶‡•ç‡§ß‡§æ ‡§∏‡•á ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡§§‡•ç‡§∞‡§ø‡§Ø ‡§∏‡§æ‡§π‡§∏, ‡§ï‡•á ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§π‡•à‡§Ç‡•§
‡§ú‡•ç‡§û‡§æ‡§®‡•Ä ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§µ‡§ø‡§µ‡•á‡§ï ‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§≤‡•á‡§§‡§æ ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£ ‡§ï‡•Ä ‡§∞‡§ö‡§®‡§æ ‡§∏‡§∞‡§≤ ‡§π‡•à‡•§
‡§ã‡§§‡•Å ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§µ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§¨‡§¶‡§≤‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï: ‡§Ö‡§®‡•Å‡§∂‡§æ‡§∏‡§® ‡§∏‡§ø‡§ñ‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§
‡§ï‡•ç‡§∑‡§Æ‡§æ ‡§∏‡•á ‡§§‡§®‡§æ‡§µ ‡§ï‡§Æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§ú‡•ç‡§û‡§æ‡§® ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∏‡•á ‡§¨‡§¢‡§º‡§§‡§æ ‡§π‡•à‡•§
‡§∂‡•ç‡§∞‡§µ‡§£ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏, ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡•§
‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§∂‡§æ‡§Ç‡§§ ‡§π‡•à‡•§
‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§∏‡•Å‡§ß‡§æ‡§∞: ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§≤‡§æ‡§§‡§æ ‡§π‡•à‡•§`

];



// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l2/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞ ‡§™‡•ã‡§§‡§æ ‡§™‡•å‡§§‡•ç‡§∞
‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞ ‡§ö‡•ã‡§™‡§∞ ‡§ö‡•å‡§§‡§∞
‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§™‡•Å‡§§‡•ç‡§§‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø ‡§ö‡•Å‡§ï‡§§‡§ø ‡§™‡§ï‡•ç‡§ï‡§ø
‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ü‡§™‡§ï‡§ø
‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞ ‡§∞‡•ã‡§ö‡§ï ‡§ö‡•å‡§™‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü ‡§ü‡•ã‡§™‡§ø ‡§∞‡•á‡§ü
‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø ‡§ü‡•ã‡§ï‡§∞‡§ø ‡§ö‡•å‡§ï‡§∞‡§ø
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞ ‡§ü‡•Å‡§ï‡§∞‡•á ‡§ï‡•å‡§ö‡§∞
‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø ‡§ï‡•Å‡§∞‡•Å‡§§‡§ø ‡§™‡•ç‡§∞‡§ï‡§§‡§ø
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞ ‡§™‡•Å‡§§‡•ç‡§§‡§∞ ‡§ï‡§ü‡•ç‡§ü‡§∞
‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§ü‡•ç‡§∞‡§ï ‡§ï‡•Ä ‡§ü‡§ï‡•ç‡§ï‡§∞
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`,

`‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å ‡§ü‡•å‡§ö‡•ã ‡§§‡•á‡§ï‡•ç‡§∞‡§ø‡§™‡•Å
‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å ‡§™‡•Å‡§∞‡§ø‡§ï‡•ç‡§§‡•á ‡§ö‡•ã‡§ü‡•å
‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§ö‡•å‡§ï‡§§‡•á ‡§™‡•Å‡§§‡•ç‡§∞
‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á ‡§ü‡•ã‡§ü‡§ï‡•á ‡§ï‡•Å‡§§‡•ç‡§§‡•á
‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø ‡§ï‡•Å‡§∞‡•Å ‡§ö‡•å‡§ï ‡§™‡§∞ ‡§ü‡§ï‡•ç‡§ï‡§∞ ‡§∞‡•ã‡§§‡§ø ‡§™‡§™‡•ç‡§™‡§ø`
]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l3/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å 
‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å
‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä ‡§¶‡•å‡§π‡§æ ‡§π‡§æ‡§ú‡•Ä
‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä ‡§ó‡•å ‡§¶‡§æ‡§¶‡§æ‡§ú‡•Ä
‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ ‡§π‡§∞‡§æ ‡§§‡•ã‡§§‡§æ
‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§™‡§∞ ‡§π‡§ü‡§æ‡§ï‡§∞ ‡§ö‡•Ä‡§§‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§™‡§∞ ‡§π‡§ü‡§æ‡§ï‡§∞ ‡§ö‡•Ä‡§§‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§™‡§∞ ‡§π‡§ü‡§æ‡§ï‡§∞ ‡§ö‡•Ä‡§§‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡•Ä‡§™‡§∞ ‡§π‡§ü‡§æ‡§ï‡§∞ ‡§ö‡•Ä‡§§‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à`,

`‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å 
‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å
‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ ‡§ö‡•å‡§ï‡§∞‡•Ä ‡§ú‡§ø‡§ó‡§∞ 
‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à
‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à ‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à ‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à ‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à ‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à ‡§ö‡•á‡§§‡§ï ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§ú‡•Ä ‡§ï‡§æ ‡§π‡•à `,

`‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å 
‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å
‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä ‡§¶‡•Ä‡§™‡•ç‡§§‡§ø ‡§¶‡§ø‡§ó‡•ç‡§ó‡•Ä
‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä ‡§ú‡•å‡§π‡§∞‡•Ä ‡§ö‡§æ‡§ö‡§æ‡§ú‡•Ä 
‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à ‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à ‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à ‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à ‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à ‡§¶‡§æ‡§¶‡§æ ‡§ï‡•Ä ‡§™‡•ã‡§§‡•Ä ‡§ú‡§ø‡§¶‡•ç‡§¶‡•Ä ‡§π‡•à `,

`‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å 
‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å
‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à ‡§π‡•Ä‡§∞‡§æ‡§ú‡•Ä ‡§ï‡•å‡§ö ‡§π‡•à 
‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞ ‡§π‡§ø‡§§‡§ï‡§∞ ‡§ú‡•Ä‡§§‡§ï‡§∞
‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡§æ‡§ú‡•Å ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡§æ‡§ú‡•Å ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡§æ‡§ú‡•Å ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à ‡§¶‡•ã‡§™‡§π‡§∞ ‡§ï‡•ã ‡§∞‡§æ‡§ú‡•Å ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à`,

`‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å 
‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å ‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä ‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å
‡§∞‡•Ä‡§§‡§æ ‡§ö‡§æ‡§ö‡•Ä ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§∞‡•Ä‡§§‡§æ ‡§ö‡§æ‡§ö‡•Ä ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§∞‡•Ä‡§§‡§æ ‡§ö‡§æ‡§ö‡•Ä ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§∞‡•Ä‡§§‡§æ ‡§ö‡§æ‡§ö‡•Ä ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§∞‡•Ä‡§§‡§æ ‡§ö‡§æ‡§ö‡•Ä ‡§ö‡§ï‡•ç‡§ï‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à
‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø ‡§ú‡§æ‡§§‡§ø ‡§™‡§æ‡§§‡§ø
‡§¶‡•Ä‡§¶‡•Ä‡§ú‡•Ä ‡§ú‡•à‡§ï‡§ø‡§ü ‡§ï‡•á ‡§™‡•à‡§ï‡§ø‡§ü ‡§ï‡•ã ‡§ö‡§æ‡§π‡§§‡•Ä ‡§π‡•à ‡§¶‡•Ä‡§¶‡•Ä‡§ú‡•Ä ‡§ú‡•à‡§ï‡§ø‡§ü ‡§ï‡•á ‡§™‡•à‡§ï‡§ø‡§ü ‡§ï‡•ã ‡§ö‡§æ‡§π‡§§‡•Ä ‡§π‡•à ‡§¶‡•Ä‡§¶‡•Ä‡§ú‡•Ä ‡§ú‡•à‡§ï‡§ø‡§ü ‡§ï‡•á ‡§™‡•à‡§ï‡§ø‡§ü ‡§ï‡•ã ‡§ö‡§æ‡§π‡§§‡•Ä ‡§π‡•à ‡§¶‡•Ä‡§¶‡•Ä‡§ú‡•Ä ‡§ú‡•à‡§ï‡§ø‡§ü ‡§ï‡•á ‡§™‡•à‡§ï‡§ø‡§ü ‡§ï‡•ã ‡§ö‡§æ‡§π‡§§‡•Ä ‡§π‡•à `

]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l4/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 1 ‡§ï‡•â‡§™‡•Ä ‡§§‡§ó‡§°‡§º‡•Ä ‡§π‡•à 
‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç‡§ú‡•Ä ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§π‡•à
‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§® ‡§π‡•á‡§™‡•ç‡§™‡•Ä ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§§‡§ó‡§°‡§º‡•Ä ‡§ú‡•Å‡§¨‡§º‡§æ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§ö‡•å‡§ï ‡§∞‡§¶‡•ç‡§¶‡•Ä ‡§ï‡§æ‡§ó‡§ú‡§º ‡§™‡§§‡•ç‡§§‡•á ‡§ó‡§ú‡§º‡§¨ ‡§ï‡§æ‡§∞‡§ø‡§ó‡§∞‡•Ä ‡§ï‡•Å‡§§‡•ç‡§§‡§æ ‡§ï‡•Å‡§ï‡•Å‡§∞ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§∞‡•â‡§ï‡•Ä ‡§ü‡•ã‡§ï‡§∞‡•Ä ‡§¶‡•Å‡§™‡§ü‡•ç‡§ü‡•á ‡§ï‡§æ ‡§ü‡•Å‡§ï‡§°‡§º‡§æ ‡§¶‡•å‡§°‡§º‡§§‡§æ ‡§™‡§ï‡§°‡§º‡§§‡•Ä ‡§™‡•Å‡§ú‡§æ‡§∞‡•Ä ‡§™‡•Ç‡§ú‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à 1 ‡§™‡§ï‡•å‡§°‡§º‡§æ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à
1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§ö‡•ã‡§∞‡•Ä ‡§°‡§ï‡•à‡§§‡•Ä ‡§π‡•ã ‡§ö‡•Å‡§ï‡•Ä ‡§π‡•à`,

`1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§§‡•ã‡§§‡§æ ‡§ï‡•ã ‡§™‡§ï‡§°‡§º‡§§‡§æ ‡§π‡•à
 ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§® ‡§π‡•á‡§™‡•ç‡§™‡•Ä ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§§‡§ó‡§°‡§º‡•Ä ‡§ú‡•Å‡§¨‡§º‡§æ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§ö‡•å‡§ï ‡§∞‡§¶‡•ç‡§¶‡•Ä ‡§ï‡§æ‡§ó‡§ú‡§º ‡§™‡§§‡•ç‡§§‡•á ‡§ó‡§ú‡§º‡§¨ ‡§ï‡§æ‡§∞‡§ø‡§ó‡§∞‡•Ä ‡§ï‡•Å‡§§‡•ç‡§§‡§æ ‡§ï‡•Å‡§ï‡•Å‡§∞ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§∞‡•â‡§ï‡•Ä ‡§ü‡•ã‡§ï‡§∞‡•Ä ‡§¶‡•Å‡§™‡§ü‡•ç‡§ü‡•á ‡§ï‡§æ ‡§ü‡•Å‡§ï‡§°‡§º‡§æ ‡§¶‡•å‡§°‡§º‡§§‡§æ ‡§™‡§ï‡§°‡§º‡§§‡•Ä ‡§™‡•Å‡§ú‡§æ‡§∞‡•Ä ‡§™‡•Ç‡§ú‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à 1 ‡§™‡§ï‡•å‡§°‡§º‡§æ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à
 ‡§∞‡§æ‡§ú‡§æ‡§ú‡•Ä ‡§ï‡•Ä ‡§ó‡•å‡§∞‡•Ä ‡§¨‡§π‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§ó‡§∞‡•Ä‡§¨ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ‡§ú‡•Ä ‡§ï‡•Ä ‡§ó‡•å‡§∞‡•Ä ‡§¨‡§π‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§ó‡§∞‡•Ä‡§¨ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ‡§ú‡•Ä ‡§ï‡•Ä ‡§ó‡•å‡§∞‡•Ä ‡§¨‡§π‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§ó‡§∞‡•Ä‡§¨ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ‡§ú‡•Ä ‡§ï‡•Ä ‡§ó‡•å‡§∞‡•Ä ‡§¨‡§π‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§ó‡§∞‡•Ä‡§¨ ‡§π‡•à ‡§∞‡§æ‡§ú‡§æ‡§ú‡•Ä ‡§ï‡•Ä ‡§ó‡•å‡§∞‡•Ä ‡§¨‡§π‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§ó‡§∞‡•Ä‡§¨ ‡§π‡•à
 ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à`,

`1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à 
 ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§® ‡§π‡•á‡§™‡•ç‡§™‡•Ä ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§§‡§ó‡§°‡§º‡•Ä ‡§ú‡•Å‡§¨‡§º‡§æ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§ö‡•å‡§ï ‡§∞‡§¶‡•ç‡§¶‡•Ä ‡§ï‡§æ‡§ó‡§ú‡§º ‡§™‡§§‡•ç‡§§‡•á ‡§ó‡§ú‡§º‡§¨ ‡§ï‡§æ‡§∞‡§ø‡§ó‡§∞‡•Ä ‡§ï‡•Å‡§§‡•ç‡§§‡§æ ‡§ï‡•Å‡§ï‡•Å‡§∞ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§∞‡•â‡§ï‡•Ä ‡§ü‡•ã‡§ï‡§∞‡•Ä ‡§¶‡•Å‡§™‡§ü‡•ç‡§ü‡•á ‡§ï‡§æ ‡§ü‡•Å‡§ï‡§°‡§º‡§æ ‡§¶‡•å‡§°‡§º‡§§‡§æ ‡§™‡§ï‡§°‡§º‡§§‡•Ä ‡§™‡•Å‡§ú‡§æ‡§∞‡•Ä ‡§™‡•Ç‡§ú‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à 1 ‡§™‡§ï‡•å‡§°‡§º‡§æ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à
 ‡§ï‡•â‡§ö ‡§ï‡§ö‡§°‡§º‡§æ ‡§™‡§ï‡•ç‡§ï‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ö‡•Å‡§¨‡§§‡•á ‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¶‡§∞‡•ç‡§¶ ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ï‡•â‡§ö ‡§ï‡§ö‡§°‡§º‡§æ ‡§™‡§ï‡•ç‡§ï‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ö‡•Å‡§¨‡§§‡•á ‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¶‡§∞‡•ç‡§¶ ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ï‡•â‡§ö ‡§ï‡§ö‡§°‡§º‡§æ ‡§™‡§ï‡•ç‡§ï‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡•ã ‡§ö‡•Å‡§¨‡§§‡•á ‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¶‡§∞‡•ç‡§¶ ‡§¶‡•á‡§§‡§æ ‡§π‡•à
 ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§ï‡•ã ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§¨‡§π‡•Å‡§§ ‡§°‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§ï‡•ã ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§¨‡§π‡•Å‡§§ ‡§°‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§ï‡•ã ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§¨‡§π‡•Å‡§§ ‡§°‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§ï‡•ã ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§¨‡§π‡•Å‡§§ ‡§°‡§∞ ‡§π‡•à ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§ï‡•ã ‡§°‡•â‡§ï‡•ç‡§ü‡§∞ ‡§ï‡§æ ‡§¨‡§π‡•Å‡§§ ‡§°‡§∞ ‡§π‡•à`,


`1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1 1‡•â‡§º‡§°‡•å‡§ú‡•å‡§¶‡•à‡§ó‡§æ‡§π‡•Ä‡§¨‡•Ç ‡§¨‡•Ç‡§π‡•Ä‡§ó‡§æ‡§¶‡•à‡§ú‡•å‡§°‡§º‡•â1
 ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à ‡§∞‡§æ‡§ú‡•Ç ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§§‡§ó‡§°‡§º‡§æ ‡§π‡•à
 ‡§ï‡§æ‡§∞‡•ç‡§ü‡•Ç‡§® ‡§π‡•á‡§™‡•ç‡§™‡•Ä ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§§‡§ó‡§°‡§º‡•Ä ‡§ú‡•Å‡§¨‡§º‡§æ ‡§¨‡§æ‡§π‡§∞‡•Ä ‡§ö‡•å‡§ï ‡§∞‡§¶‡•ç‡§¶‡•Ä ‡§ï‡§æ‡§ó‡§ú‡§º ‡§™‡§§‡•ç‡§§‡•á ‡§ó‡§ú‡§º‡§¨ ‡§ï‡§æ‡§∞‡§ø‡§ó‡§∞‡•Ä ‡§ï‡•Å‡§§‡•ç‡§§‡§æ ‡§ï‡•Å‡§ï‡•Å‡§∞ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§∞‡•â‡§ï‡•Ä ‡§ü‡•ã‡§ï‡§∞‡•Ä ‡§¶‡•Å‡§™‡§ü‡•ç‡§ü‡•á ‡§ï‡§æ ‡§ü‡•Å‡§ï‡§°‡§º‡§æ ‡§¶‡•å‡§°‡§º‡§§‡§æ ‡§™‡§ï‡§°‡§º‡§§‡•Ä ‡§™‡•Å‡§ú‡§æ‡§∞‡•Ä ‡§™‡•Ç‡§ú‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à 1 ‡§™‡§ï‡•å‡§°‡§º‡§æ ‡§™‡•Å‡§ï‡§æ‡§∞‡§§‡§æ ‡§π‡•à
 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§∞‡§æ‡§ú‡•Ç ‡§ï‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§™ ‡§∞‡§π‡§æ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§∞‡§æ‡§ú‡•Ç ‡§ï‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§™ ‡§∞‡§π‡§æ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§∞‡§æ‡§ú‡•Ç ‡§ï‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§™ ‡§∞‡§π‡§æ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§∞‡§æ‡§ú‡•Ç ‡§ï‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§™ ‡§∞‡§π‡§æ ‡§π‡•à 1 ‡§¨‡§æ‡§∞ ‡§§‡•ã ‡§∞‡§æ‡§ú‡•Ç ‡§ï‡§æ‡§∞ ‡§™‡§∞ ‡§ï‡•â‡§™ ‡§∞‡§π‡§æ ‡§π‡•à 
 ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à ‡§ú‡•ã ‡§ï‡§æ‡§∞‡§§‡•Ç‡§§ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•à
 ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ ‡§¨‡§æ‡§¨‡•Ç ‡§ú‡•Ä ‡§™‡§∞ ‡§¨‡§æ‡§§ ‡§ï‡§∞‡•Ç‡§ó‡§æ `
]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l5/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ, ‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§Æ,
‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç. ‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç. ‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç. ‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç. ‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç. ‡§™‡§∞‡§Æ‡•Ç ‡§ï‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§Ø ‡§®‡§π‡•Ä ‡§™‡•Ä‡§§‡§æ ‡§π‡•à‡§Ç.
‡§π‡§∞ ‡§∏‡§Æ‡§Ø, ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã, ‡§∏‡§π‡§ú‡§§‡§æ ‡§∏‡•á, ‡§™‡§ï‡§°‡§º‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§π‡§∞ ‡§∏‡§Æ‡§Ø, ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã, ‡§∏‡§π‡§ú‡§§‡§æ ‡§∏‡•á, ‡§™‡§ï‡§°‡§º‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§π‡§∞ ‡§∏‡§Æ‡§Ø, ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã, ‡§∏‡§π‡§ú‡§§‡§æ ‡§∏‡•á, ‡§™‡§ï‡§°‡§º‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§π‡§∞ ‡§∏‡§Æ‡§Ø, ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã, ‡§∏‡§π‡§ú‡§§‡§æ ‡§∏‡•á, ‡§™‡§ï‡§°‡§º‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç.
‡§¨‡§æ‡§ú‡•Ç ‡§ï‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç, ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡•á ‡§¨‡§°‡§º‡•á ‡§¨‡§®‡•ç‡§¶‡§∞ ‡§π‡•à‡§Ç, ‡§¨‡§æ‡§ú‡•Ç ‡§ï‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç, ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡•á ‡§¨‡§°‡§º‡•á ‡§¨‡§®‡•ç‡§¶‡§∞ ‡§π‡•à‡§Ç, ‡§¨‡§æ‡§ú‡•Ç ‡§ï‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç, ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡•á ‡§¨‡§°‡§º‡•á ‡§¨‡§®‡•ç‡§¶‡§∞ ‡§π‡•à‡§Ç, ‡§¨‡§æ‡§ú‡•Ç ‡§ï‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç, ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡•á ‡§¨‡§°‡§º‡•á ‡§¨‡§®‡•ç‡§¶‡§∞ ‡§π‡•à‡§Ç,
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç.`,

`‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ú‡•Ä‡§§‡§®‡§æ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡§π‡§ú‡§§‡§æ ‡§π‡•à‡§Ç. ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ú‡•Ä‡§§‡§®‡§æ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡§π‡§ú‡§§‡§æ ‡§π‡•à‡§Ç. ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§ú‡•Ä‡§§‡§®‡§æ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡§π‡§ú‡§§‡§æ ‡§π‡•à‡§Ç.
‡§ö‡§æ‡§Ø ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡•á‡§π‡§§ ‡§ï‡•ã ‡§¨‡§ø‡§ó‡§æ‡§°‡§º‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡•á ‡§ï‡§Æ ‡§™‡•Ä‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§ö‡§æ‡§Ø ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡•á‡§π‡§§ ‡§ï‡•ã ‡§¨‡§ø‡§ó‡§æ‡§°‡§º‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡•á ‡§ï‡§Æ ‡§™‡•Ä‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§ö‡§æ‡§Ø ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡•á‡§π‡§§ ‡§ï‡•ã ‡§¨‡§ø‡§ó‡§æ‡§°‡§º‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡•á ‡§ï‡§Æ ‡§™‡•Ä‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç. ‡§ö‡§æ‡§Ø ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§∏‡•á‡§π‡§§ ‡§ï‡•ã ‡§¨‡§ø‡§ó‡§æ‡§°‡§º‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡•á ‡§ï‡§Æ ‡§™‡•Ä‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á‡§Ç.
‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§Æ‡•Ç ‡§ï‡§æ‡§ï‡§æ ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç,
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç.`,

`‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§ï‡•å‡§® ‡§∏‡§æ ‡§∞‡§Ç‡§ó ‡§∏‡§¨‡§∏‡•á ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ï‡•å‡§® ‡§∏‡§æ ‡§∞‡§Ç‡§ó ‡§∏‡§¨‡§∏‡•á ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ï‡•å‡§® ‡§∏‡§æ ‡§∞‡§Ç‡§ó ‡§∏‡§¨‡§∏‡•á ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ï‡•å‡§® ‡§∏‡§æ ‡§∞‡§Ç‡§ó ‡§∏‡§¨‡§∏‡•á ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ï‡•å‡§® ‡§∏‡§æ ‡§∞‡§Ç‡§ó ‡§∏‡§¨‡§∏‡•á ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, 
‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä. ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§Ø‡§æ‡§∞‡•Ä, ‡§∏‡§¨‡§∏‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä.
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§Ø. ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡•Å‡§π‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§Ø. ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡•Å‡§π‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§Ø. ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡•Å‡§π‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§Ø. ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡•Å‡§π‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§Ø. ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§∏‡•Å‡§π‡§æ‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç,
‡§ú‡•ã ‡§∏‡§ö ‡§ï‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡§π‡•Ä ‡§°‡§∞‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç. ‡§ú‡•ã ‡§∏‡§ö ‡§ï‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡§π‡•Ä ‡§°‡§∞‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç. ‡§ú‡•ã ‡§∏‡§ö ‡§ï‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡§π‡•Ä ‡§°‡§∞‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç. ‡§ú‡•ã ‡§∏‡§ö ‡§ï‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡§π‡•Ä ‡§°‡§∞‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç. ‡§ú‡•ã ‡§∏‡§ö ‡§ï‡§π‡§§‡§æ ‡§π‡•à, ‡§ï‡§π‡•Ä ‡§°‡§∞‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç.
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç.`,

`‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§ï‡•å‡§® ‡§®‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§ï‡§æ ‡§™‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡•ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç. ‡§ï‡•å‡§® ‡§®‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§ï‡§æ ‡§™‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡•ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç. ‡§ï‡•å‡§® ‡§®‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§ï‡§æ ‡§™‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡•ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç.
‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§ï‡§æ‡§Ø‡§∞ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§ï‡§ø ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞‡•Ä ‡§∏‡•á ‡§π‡§∞ ‡§ú‡§ó‡§π ‡§∏‡§ö ‡§π‡•Ä ‡§ï‡§π‡§§‡§æ ‡§π‡•à‡§Ç. ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§ï‡§æ‡§Ø‡§∞ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§ï‡§ø ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞‡•Ä ‡§∏‡•á ‡§π‡§∞ ‡§ú‡§ó‡§π ‡§∏‡§ö ‡§π‡•Ä ‡§ï‡§π‡§§‡§æ ‡§π‡•à‡§Ç. ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§ï‡§æ‡§Ø‡§∞ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§ï‡§ø ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞‡•Ä ‡§∏‡•á ‡§π‡§∞ ‡§ú‡§ó‡§π ‡§∏‡§ö ‡§π‡•Ä ‡§ï‡§π‡§§‡§æ ‡§π‡•à‡§Ç.
‡§¨‡§°‡§º‡§ø‡§Ø‡§æ ‡§ï‡§∞‡•ç‡§Æ ‡§ï‡•Ä ‡§∏‡§¶‡§æ ‡§π‡•Ä ‡§ú‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§¨‡§°‡§º‡§ø‡§Ø‡§æ ‡§ï‡§∞‡•ç‡§Æ ‡§ï‡•Ä ‡§∏‡§¶‡§æ ‡§π‡•Ä ‡§ú‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§¨‡§°‡§º‡§ø‡§Ø‡§æ ‡§ï‡§∞‡•ç‡§Æ ‡§ï‡•Ä ‡§∏‡§¶‡§æ ‡§π‡•Ä ‡§ú‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§¨‡§°‡§º‡§ø‡§Ø‡§æ ‡§ï‡§∞‡•ç‡§Æ ‡§ï‡•Ä ‡§∏‡§¶‡§æ ‡§π‡•Ä ‡§ú‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç, ‡§¨‡§°‡§º‡§ø‡§Ø‡§æ ‡§ï‡§∞‡•ç‡§Æ ‡§ï‡•Ä ‡§∏‡§¶‡§æ ‡§π‡•Ä ‡§ú‡§Ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç,
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç.`,

`‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç ‡§∏,.‡§Ø ‡§®‡§Æ‡§Ç
‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§π‡§Æ ‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç. ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§π‡§Æ ‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç. ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§π‡§Æ ‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç. ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§π‡§Æ ‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç. ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ, ‡§π‡§Æ ‡§π‡•Ä ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç.
‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡•Ä‡§§.
‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç. ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ ‡§¨‡§π‡•Å‡§§ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§π‡•à‡§Ç.
‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§∏‡§æ‡§Ø‡§Ç ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç. ‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•ã, ‡§®‡§Æ‡§® ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç.`
]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l6/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç
‡§µ‡§π ‡§≤‡§°‡§º‡§ï‡§æ ‡§ú‡•ã ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§π‡•à, ‡§µ‡•Ä‡§∞‡§¨‡§π‡•Ç‡§¨‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç.‡§µ‡§π ‡§≤‡§°‡§º‡§ï‡§æ ‡§ú‡•ã ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§π‡•à, ‡§µ‡•Ä‡§∞‡§¨‡§π‡•Ç‡§¨‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç.‡§µ‡§π ‡§≤‡§°‡§º‡§ï‡§æ ‡§ú‡•ã ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§π‡•à, ‡§µ‡•Ä‡§∞‡§¨‡§π‡•Ç‡§¨‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç.‡§µ‡§π ‡§≤‡§°‡§º‡§ï‡§æ ‡§ú‡•ã ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§¨‡§π‡§æ‡§¶‡•Å‡§∞ ‡§π‡•à, ‡§µ‡•Ä‡§∞‡§¨‡§π‡•Ç‡§¨‡§≤‡•Ä ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç.
‡§∏‡§§‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡§¶‡•à‡§µ ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç. ‡§∏‡§§‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡§¶‡•à‡§µ ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç.‡§∏‡§§‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡§¶‡•à‡§µ ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç.‡§∏‡§§‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡§¶‡•à‡§µ ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç.
‡§µ‡•Ä‡§∞‡§æ‡§Ç‡§ó‡§®‡§æ ‡§∞‡§æ‡§®‡•Ä ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ‡§µ‡§§‡•Ä, ‡§∏‡§¶‡•à‡§µ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡•ã‡§Ç ‡§ú‡•Ä‡§µ‡§ø‡§§ ‡§∞‡§π‡•á‡§ó‡•Ä‡§Ç. ‡§µ‡•Ä‡§∞‡§æ‡§Ç‡§ó‡§®‡§æ ‡§∞‡§æ‡§®‡•Ä ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ‡§µ‡§§‡•Ä, ‡§∏‡§¶‡•à‡§µ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡•ã‡§Ç ‡§ú‡•Ä‡§µ‡§ø‡§§ ‡§∞‡§π‡•á‡§ó‡•Ä‡§Ç.‡§µ‡•Ä‡§∞‡§æ‡§Ç‡§ó‡§®‡§æ ‡§∞‡§æ‡§®‡•Ä ‡§¶‡•Å‡§∞‡•ç‡§ó‡§æ‡§µ‡§§‡•Ä, ‡§∏‡§¶‡•à‡§µ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡•ã‡§Ç ‡§ú‡•Ä‡§µ‡§ø‡§§ ‡§∞‡§π‡•á‡§ó‡•Ä‡§Ç.
‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•Ä ‡§≤‡•ã‡§ï‡§≤ ‡§¨‡§∏, ‡§ï‡§≤ ‡§∏‡•á ‡§≤‡•á‡§ü ‡§ú‡§æ‡§Ø‡•á‡§ó‡•Ä‡§Ç. ‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•Ä ‡§≤‡•ã‡§ï‡§≤ ‡§¨‡§∏, ‡§ï‡§≤ ‡§∏‡•á ‡§≤‡•á‡§ü ‡§ú‡§æ‡§Ø‡•á‡§ó‡•Ä‡§Ç. ‡§Ø‡§π‡§æ‡§Ç ‡§ï‡•Ä ‡§≤‡•ã‡§ï‡§≤ ‡§¨‡§∏, ‡§ï‡§≤ ‡§∏‡•á ‡§≤‡•á‡§ü ‡§ú‡§æ‡§Ø‡•á‡§ó‡•Ä‡§Ç.
‡§µ‡§ø‡§∏‡•ç‡§µ‡§æ‡§∏ ‡§ú‡•Ä‡§§‡§®‡§æ ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§π‡•à, ‡§ú‡§¨‡§ï‡§ø ‡§µ‡§ø‡§∏‡•ç‡§µ‡§æ‡§∏ ‡§ü‡•Ç‡§ü‡§§‡§æ ‡§¨‡§π‡•Å‡§§ ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§π‡•à‡§Ç. ‡§µ‡§ø‡§∏‡•ç‡§µ‡§æ‡§∏ ‡§ú‡•Ä‡§§‡§®‡§æ ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§π‡•à, ‡§ú‡§¨‡§ï‡§ø ‡§µ‡§ø‡§∏‡•ç‡§µ‡§æ‡§∏ ‡§ü‡•Ç‡§ü‡§§‡§æ ‡§¨‡§π‡•Å‡§§ ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§π‡•à‡§Ç.`,

`‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç
‡§ú‡•ã ‡§¨‡§ø‡§®‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡§Ç, ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç. ‡§ú‡•ã ‡§¨‡§ø‡§®‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡§Ç, ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§®‡•Å‡§ï‡§∏‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡§Ç.
‡§µ‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§ó‡§≤‡§§ ‡§π‡•à‡§Ç, ‡§∏‡§ö ‡§ï‡•ã ‡§∏‡§æ‡§Æ‡§®‡•á ‡§® ‡§≤‡§æ‡§®‡•á ‡§¶‡•á‡§®‡§æ. ‡§µ‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§ó‡§≤‡§§ ‡§π‡•à‡§Ç, ‡§∏‡§ö ‡§ï‡•ã ‡§∏‡§æ‡§Æ‡§®‡•á ‡§® ‡§≤‡§æ‡§®‡•á ‡§¶‡•á‡§®‡§æ. ‡§µ‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§ó‡§≤‡§§ ‡§π‡•à‡§Ç, ‡§∏‡§ö ‡§ï‡•ã ‡§∏‡§æ‡§Æ‡§®‡•á ‡§® ‡§≤‡§æ‡§®‡•á ‡§¶‡•á‡§®‡§æ.
‡§ï‡§≤ ‡§ï‡§≤ ‡§ï‡§∞‡§ï‡•á ‡§¨‡§π‡§§‡•Ä ‡§®‡§¶‡§ø‡§Ø‡§æ‡§Ç, ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡§Ç. ‡§ï‡§≤ ‡§ï‡§≤ ‡§ï‡§∞‡§ï‡•á ‡§¨‡§π‡§§‡•Ä ‡§®‡§¶‡§ø‡§Ø‡§æ‡§Ç, ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡§Ç.‡§ï‡§≤ ‡§ï‡§≤ ‡§ï‡§∞‡§ï‡•á ‡§¨‡§π‡§§‡•Ä ‡§®‡§¶‡§ø‡§Ø‡§æ‡§Ç, ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à‡§Ç.
‡§≤‡§π‡§∏‡•Å‡§® ‡§™‡•ç‡§Ø‡§æ‡§ú ‡§ï‡§æ ‡§§‡•ç‡§Ø‡§æ‡§ó ‡§ï‡§∞‡§®‡§æ, ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç. ‡§≤‡§π‡§∏‡•Å‡§® ‡§™‡•ç‡§Ø‡§æ‡§ú ‡§ï‡§æ ‡§§‡•ç‡§Ø‡§æ‡§ó ‡§ï‡§∞‡§®‡§æ, ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç.‡§≤‡§π‡§∏‡•Å‡§® ‡§™‡•ç‡§Ø‡§æ‡§ú ‡§ï‡§æ ‡§§‡•ç‡§Ø‡§æ‡§ó ‡§ï‡§∞‡§®‡§æ, ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§ø‡§≤ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡§Ç.`,
`‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç ‡§≤‡§∏,.‡§Ø ‡§µ‡§®‡§Æ‡§Ç
‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§®‡•ç‡§¶‡§ó‡§º‡•Ä ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç. ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§®‡•ç‡§¶‡§ó‡§º‡•Ä ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç.‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§®‡•ç‡§¶‡§ó‡§º‡•Ä ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç.‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡•Å‡§®‡§¶‡•ç‡§∞ ‡§µ‡§ø‡§ö‡§æ‡§∞, ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§®‡•ç‡§¶‡§ó‡§º‡•Ä ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç.
‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§ö‡§æ‡§∞‡•ã ‡§ï‡•á ‡§∞‡•ã‡§ï‡§®‡§æ, ‡§®‡§æ‡§Æ‡•Å‡§Æ‡§ï‡§ø‡§® ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§ó‡§≤‡§§ ‡§µ‡§ø‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§µ‡§ø‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§®‡§æ ‡§Æ‡•Å‡§Æ‡§ï‡§ø‡§® ‡§π‡•à‡§Ç.
‡§ó‡§≤‡§§‡•Ä ‡§∏‡§¨ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§π‡•Ä ‡§ï‡§∞‡§§‡§æ, ‡§Ø‡§æ‡§®‡§ø ‡§∏‡§Æ‡§æ‡§® ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•Å‡§π‡§∞‡§æ‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç. ‡§ó‡§≤‡§§‡•Ä ‡§∏‡§¨ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§π‡•Ä ‡§ï‡§∞‡§§‡§æ, ‡§Ø‡§æ‡§®‡§ø ‡§∏‡§Æ‡§æ‡§® ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•Å‡§π‡§∞‡§æ‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç.‡§ó‡§≤‡§§‡•Ä ‡§∏‡§¨ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§π‡•Ä ‡§ï‡§∞‡§§‡§æ, ‡§Ø‡§æ‡§®‡§ø ‡§∏‡§Æ‡§æ‡§® ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•Å‡§π‡§∞‡§æ‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç.‡§ó‡§≤‡§§‡•Ä ‡§∏‡§¨ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§π‡•Ä ‡§ï‡§∞‡§§‡§æ, ‡§Ø‡§æ‡§®‡§ø ‡§∏‡§Æ‡§æ‡§® ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•Å‡§π‡§∞‡§æ‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç.‡§ó‡§≤‡§§‡•Ä ‡§∏‡§¨ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§µ‡§π ‡§∏‡§¶‡•à‡§µ ‡§π‡•Ä ‡§µ‡§ø‡§ú‡§Ø‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡§Ç, ‡§ú‡•ã ‡§µ‡§π‡•Ä ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§π‡•Ä ‡§ï‡§∞‡§§‡§æ, ‡§Ø‡§æ‡§®‡§ø ‡§∏‡§Æ‡§æ‡§® ‡§ó‡§≤‡§§‡•Ä ‡§¶‡•Å‡§π‡§∞‡§æ‡§§‡§æ ‡§®‡§π‡•Ä ‡§π‡•à‡§Ç.`

]

// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l8/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô
‡§≠‡§æ‡§∞‡•Ä ‡§ß‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ä‡§Å‡§ö‡•á ‡§™‡§π‡§æ‡§°‡§º ‡§ö‡§Æ‡§ï ‡§∞‡§π‡•á ‡§•‡•á. ‡§≠‡§æ‡§∞‡•Ä ‡§ß‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ä‡§Å‡§ö‡•á ‡§™‡§π‡§æ‡§°‡§º ‡§ö‡§Æ‡§ï ‡§∞‡§π‡•á ‡§•‡•á.
‡§ù‡•ã‡§™‡§°‡§º‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§¢‡•ã‡§≤ ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú ‡§Ü‡§à. ‡§ù‡•ã‡§™‡§°‡§º‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§¢‡•ã‡§≤ ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú ‡§Ü‡§à.
‡§ò‡§®‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§π‡§æ‡§•‡•Ä ‡§î‡§∞ ‡§≠‡•à‡§Ç‡§∏ ‡§¶‡§ø‡§ñ‡•á. ‡§ò‡§®‡•á ‡§ú‡§Ç‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§π‡§æ‡§•‡•Ä ‡§î‡§∞ ‡§≠‡•à‡§Ç‡§∏ ‡§¶‡§ø‡§ñ‡•á.
‡§ê‡§∏‡•Ä ‡§ß‡•à‡§∞‡•ç‡§Ø ‡§µ‡§æ‡§≤‡•Ä ‡§∏‡•ã‡§ö ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§æ‡§§‡•Ä ‡§π‡•à. ‡§ê‡§∏‡•Ä ‡§ß‡•à‡§∞‡•ç‡§Ø ‡§µ‡§æ‡§≤‡•Ä ‡§∏‡•ã‡§ö ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§æ‡§§‡•Ä ‡§π‡•à.
‡§î‡§∑‡§ß‡§ø ‡§∏‡•á ‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä ‡§ß‡•Ä‡§∞‡•á ‡§†‡•Ä‡§ï ‡§π‡•Å‡§à. ‡§î‡§∑‡§ß‡§ø ‡§∏‡•á ‡§¨‡•Ä‡§Æ‡§æ‡§∞‡•Ä ‡§ß‡•Ä‡§∞‡•á ‡§†‡•Ä‡§ï ‡§π‡•Å‡§à.`,

`‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô
‡§≠‡§æ‡§à ‡§®‡•á ‡§ä‡§® ‡§ï‡§æ ‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§™‡§°‡§º‡§æ ‡§™‡§π‡§®‡§æ. ‡§≠‡§æ‡§à ‡§®‡•á ‡§ä‡§® ‡§ï‡§æ ‡§ó‡§∞‡•ç‡§Æ ‡§ï‡§™‡§°‡§º‡§æ ‡§™‡§π‡§®‡§æ.
‡§ù‡•Ä‡§≤ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§¢‡§≤‡§æ‡§® ‡§¨‡§π‡•Å‡§§ ‡§§‡•Ä‡§ñ‡•Ä ‡§•‡•Ä. ‡§ù‡•Ä‡§≤ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§¢‡§≤‡§æ‡§® ‡§¨‡§π‡•Å‡§§ ‡§§‡•Ä‡§ñ‡•Ä ‡§•‡•Ä.
‡§ò‡§Ç‡§ü‡§æ ‡§¨‡§ú‡§§‡•á ‡§π‡•Ä ‡§≠‡•Ä‡§°‡§º ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•Ä. ‡§ò‡§Ç‡§ü‡§æ ‡§¨‡§ú‡§§‡•á ‡§π‡•Ä ‡§≠‡•Ä‡§°‡§º ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•Ä.
‡§ê‡§§‡§ø‡§π‡§æ‡§∏‡§ø‡§ï ‡§ß‡§∞‡•ã‡§π‡§∞ ‡§∏‡§¨‡§ï‡•ã ‡§≠‡§æ‡§§‡•Ä ‡§π‡•à. ‡§ê‡§§‡§ø‡§π‡§æ‡§∏‡§ø‡§ï ‡§ß‡§∞‡•ã‡§π‡§∞ ‡§∏‡§¨‡§ï‡•ã ‡§≠‡§æ‡§§‡•Ä ‡§π‡•à.
‡§î‡§ú‡§æ‡§∞ ‡§∏‡§π‡•Ä ‡§π‡•ã‡§Ç ‡§§‡•ã ‡§ï‡§æ‡§Æ ‡§Ü‡§∏‡§æ‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à. ‡§î‡§ú‡§æ‡§∞ ‡§∏‡§π‡•Ä ‡§π‡•ã‡§Ç ‡§§‡•ã ‡§ï‡§æ‡§Æ ‡§Ü‡§∏‡§æ‡§® ‡§π‡•ã‡§§‡§æ ‡§π‡•à.`,

`‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô
‡§ä‡§Å‡§ü ‡§∞‡•á‡§ó‡§ø‡§∏‡•ç‡§§‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§∞‡•Ä ‡§≠‡§æ‡§∞ ‡§¢‡•ã‡§§‡§æ ‡§π‡•à. ‡§ä‡§Å‡§ü ‡§∞‡•á‡§ó‡§ø‡§∏‡•ç‡§§‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§∞‡•Ä ‡§≠‡§æ‡§∞ ‡§¢‡•ã‡§§‡§æ ‡§π‡•à.
‡§ù‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ß‡•ç‡§µ‡§®‡§ø ‡§Æ‡§® ‡§ï‡•ã ‡§≠‡§æ‡§§‡•Ä ‡§π‡•à. ‡§ù‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ß‡•ç‡§µ‡§®‡§ø ‡§Æ‡§® ‡§ï‡•ã ‡§≠‡§æ‡§§‡•Ä ‡§π‡•à.
‡§ò‡§∞‡•á‡§≤‡•Ç ‡§≠‡•ã‡§ú‡§® ‡§∏‡•á ‡§∂‡§∞‡•Ä‡§∞ ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§¨‡§®‡§§‡§æ ‡§π‡•à. ‡§ò‡§∞‡•á‡§≤‡•Ç ‡§≠‡•ã‡§ú‡§® ‡§∏‡•á ‡§∂‡§∞‡•Ä‡§∞ ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§¨‡§®‡§§‡§æ ‡§π‡•à.
‡§ê‡§∏‡•Ä ‡§Ü‡§¶‡§§‡•á‡§Ç ‡§Ü‡§ó‡•á ‡§≤‡§æ‡§≠ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç. ‡§ê‡§∏‡•Ä ‡§Ü‡§¶‡§§‡•á‡§Ç ‡§Ü‡§ó‡•á ‡§≤‡§æ‡§≠ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à‡§Ç.
‡§î‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§π‡•Å‡§Ü ‡§π‡•à. ‡§î‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§π‡•Å‡§Ü ‡§π‡•à.`,

`‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô
‡§≠‡•ã‡§∞ ‡§Æ‡•á‡§Ç ‡§ß‡•Å‡§Ç‡§ß ‡§õ‡§æ‡§à ‡§π‡•Å‡§à ‡§•‡•Ä. ‡§≠‡•ã‡§∞ ‡§Æ‡•á‡§Ç ‡§ß‡•Å‡§Ç‡§ß ‡§õ‡§æ‡§à ‡§π‡•Å‡§à ‡§•‡•Ä.
‡§ù‡§æ‡§°‡§º‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§¢‡§≤‡§§‡•Ä ‡§ß‡•Ç‡§™ ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à. ‡§ù‡§æ‡§°‡§º‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§¢‡§≤‡§§‡•Ä ‡§ß‡•Ç‡§™ ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à.
‡§ò‡§Ç‡§ü‡•Ä ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú ‡§∏‡•Å‡§®‡§ï‡§∞ ‡§∏‡§¨ ‡§Ü‡§ó‡•á ‡§Ü‡§è. ‡§ò‡§Ç‡§ü‡•Ä ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú ‡§∏‡•Å‡§®‡§ï‡§∞ ‡§∏‡§¨ ‡§Ü‡§ó‡•á ‡§Ü‡§è.
‡§ê‡§∏‡§æ ‡§ß‡•à‡§∞‡•ç‡§Ø ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§ï‡§æ‡§Æ ‡§Ü‡§§‡§æ ‡§π‡•à. ‡§ê‡§∏‡§æ ‡§ß‡•à‡§∞‡•ç‡§Ø ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§ï‡§æ‡§Æ ‡§Ü‡§§‡§æ ‡§π‡•à.
‡§î‡§∏‡§§ ‡§Æ‡•á‡§π‡§®‡§§ ‡§∏‡•á ‡§≠‡•Ä ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à. ‡§î‡§∏‡§§ ‡§Æ‡•á‡§π‡§®‡§§ ‡§∏‡•á ‡§≠‡•Ä ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à.`,

`‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô ‡§î‡§ê‡§Ü‡§à‡§ä‡§à ‡§û‡§¢‡§ù‡§ß‡§ò‡§ô‡§≠‡§ô
‡§≠‡§ï‡•ç‡§§ ‡§ä‡§Å‡§ö‡•á ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ï‡•Ä ‡§∏‡•Ä‡§¢‡§º‡§ø‡§Ø‡§æ‡§Å ‡§ö‡§¢‡§º‡•á. ‡§≠‡§ï‡•ç‡§§ ‡§ä‡§Å‡§ö‡•á ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ï‡•Ä ‡§∏‡•Ä‡§¢‡§º‡§ø‡§Ø‡§æ‡§Å ‡§ö‡§¢‡§º‡•á.
‡§ù‡•Å‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§π‡§æ‡§•‡•Ä ‡§ò‡§æ‡§∏ ‡§ñ‡§æ ‡§∞‡§π‡•á ‡§•‡•á. ‡§ù‡•Å‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§π‡§æ‡§•‡•Ä ‡§ò‡§æ‡§∏ ‡§ñ‡§æ ‡§∞‡§π‡•á ‡§•‡•á.
‡§¢‡•ã‡§≤ ‡§î‡§∞ ‡§®‡§ó‡§æ‡§°‡§º‡•á ‡§ï‡•Ä ‡§ß‡•ç‡§µ‡§®‡§ø ‡§ó‡•Ç‡§Ç‡§ú‡•Ä. ‡§¢‡•ã‡§≤ ‡§î‡§∞ ‡§®‡§ó‡§æ‡§°‡§º‡•á ‡§ï‡•Ä ‡§ß‡•ç‡§µ‡§®‡§ø ‡§ó‡•Ç‡§Ç‡§ú‡•Ä.
‡§ê‡§∏‡•Ä ‡§≠‡§æ‡§µ‡§®‡§æ ‡§∏‡§¨‡§ï‡•ã ‡§ú‡•ã‡§°‡§º‡§§‡•Ä ‡§π‡•à. ‡§ê‡§∏‡•Ä ‡§≠‡§æ‡§µ‡§®‡§æ ‡§∏‡§¨‡§ï‡•ã ‡§ú‡•ã‡§°‡§º‡§§‡•Ä ‡§π‡•à.
‡§î‡§™‡§ö‡§æ‡§∞‡§ø‡§ï ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§™‡§§‡•ç‡§∞ ‡§≤‡§ø‡§ñ‡§æ ‡§ó‡§Ø‡§æ. ‡§î‡§™‡§ö‡§æ‡§∞‡§ø‡§ï ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§™‡§§‡•ç‡§∞ ‡§≤‡§ø‡§ñ‡§æ ‡§ó‡§Ø‡§æ.`
]


// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l9/">Typing test Speed Hindi Tradition -Lassion 2</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [

`‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å  ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å 

‡§∂‡§∂‡§ø ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§ï‡•á ‡§ï‡§ø‡§®‡§æ‡§∞‡•á ‡§∞‡§π‡§æ ‡§ï‡§∞‡§§‡§æ ‡§•‡§æ‡•§ 
‡§∑‡§ü‡•ç‡§ï‡•ã‡§£ ‡§Æ‡•á‡§Ç ‡§õ‡§π ‡§≠‡•Å‡§ú‡§æ‡§è‡§Å ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ 
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§¨‡§π‡§§‡•Ä ‡§π‡•à‡•§ 
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§∑‡§∑‡•ç‡§†‡•Ä ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§™‡§¢‡§º‡§æ‡§Ø‡§æ‡•§ 
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§ñ‡•á‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§™‡§æ‡§®‡•Ä ‡§™‡§ø‡§Ø‡§æ‡•§ 
‡§ó‡§£‡§Å‡§ø‡§§ ‡§Æ‡•á‡§Ç ‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§Ü‡§Ø‡§æ ‡§•‡§æ‡•§ 
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§ï‡•á ‡§§‡§ü ‡§™‡§∞ ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§õ‡§æ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§ 
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§´‡•Ç‡§≤ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§î‡§∞ ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§•‡•á‡•§ 
‡§∑‡§∑‡•ç‡§† ‡§¶‡§ø‡§® ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§Ü‡§Ø‡§æ‡•§ 
‡§∂‡§∂‡§ø ‡§®‡•á ‡§ï‡§π‡§æ ‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§ø‡§∑‡§Ø ‡§ï‡§†‡§ø‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§

‡§∂‡§∂‡§ø ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§ï‡•á ‡§ï‡§ø‡§®‡§æ‡§∞‡•á ‡§∞‡§π‡§æ ‡§ï‡§∞‡§§‡§æ ‡§•‡§æ‡•§
‡§∑‡§ü‡•ç‡§ï‡•ã‡§£ ‡§Æ‡•á‡§Ç ‡§õ‡§π ‡§≠‡•Å‡§ú‡§æ‡§è‡§Å ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§®‡§¶‡•Ä ‡§¨‡§π‡§§‡•Ä ‡§π‡•à‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§∑‡§∑‡•ç‡§†‡•Ä ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§™‡§¢‡§º‡§æ‡§Ø‡§æ‡•§
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§ñ‡•á‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§™‡§æ‡§®‡•Ä ‡§™‡§ø‡§Ø‡§æ‡•§
‡§ó‡§£‡§Å‡§ø‡§§ ‡§Æ‡•á‡§Ç ‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§Ü‡§Ø‡§æ ‡§•‡§æ‡•§
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§ï‡•á ‡§§‡§ü ‡§™‡§∞ ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§õ‡§æ ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§´‡•Ç‡§≤ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§î‡§∞ ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§•‡•á‡•§
‡§∑‡§∑‡•ç‡§† ‡§¶‡§ø‡§® ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§Ü‡§Ø‡§æ‡•§
‡§∂‡§∂‡§ø ‡§®‡•á ‡§ï‡§π‡§æ ‡§ï‡§ø ‡§Ø‡§π ‡§µ‡§ø‡§∑‡§Ø ‡§ï‡§†‡§ø‡§® ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§`,

`‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å 

‡§∂‡§∂‡§ø ‡§®‡•á ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡•á‡§ñ ‡§≤‡§ø‡§ñ‡§æ‡•§ 
‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§Ü‡§ï‡•É‡§§‡§ø ‡§ó‡§£‡§Å‡§ø‡§§ ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§æ‡§à ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§ 
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•Ä ‡§ß‡§∞‡§§‡•Ä ‡§â‡§™‡§ú‡§æ‡§ä ‡§π‡•à‡•§ 
‡§¨‡§æ‡§≥‡§ï ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§∏‡•á ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§†‡§æ ‡§•‡§æ‡•§ 
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§§‡§ü ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§ 
‡§∑‡§∑‡•ç‡§† ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ò‡•ã‡§∑‡§ø‡§§ ‡§π‡•Å‡§Ü‡•§ 
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ó‡§Ç‡§ß‡§ø‡§§ ‡§´‡•Ç‡§≤ ‡§™‡§ø‡§∞‡•ã‡§è ‡§ó‡§è‡•§ 
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§∂‡§ø‡§∑‡•ç‡§Ø ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ‡•§

‡§∂‡§∂‡§ø ‡§®‡•á ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§≤‡•á‡§ñ ‡§≤‡§ø‡§ñ‡§æ‡•§
‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§Ü‡§ï‡•É‡§§‡§ø ‡§ó‡§£‡§Å‡§ø‡§§ ‡§Æ‡•á‡§Ç ‡§™‡§¢‡§º‡§æ‡§à ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•Ä ‡§ß‡§∞‡§§‡•Ä ‡§â‡§™‡§ú‡§æ‡§ä ‡§π‡•à‡•§
‡§¨‡§æ‡§≥‡§ï ‡§∂‡§æ‡§Ç‡§§‡§ø ‡§∏‡•á ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§†‡§æ ‡§•‡§æ‡•§
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§®‡§∞‡•ç‡§Æ‡§¶‡§æ ‡§§‡§ü ‡§∏‡•Å‡§Ç‡§¶‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à‡•§
‡§∑‡§∑‡•ç‡§† ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ò‡•ã‡§∑‡§ø‡§§ ‡§π‡•Å‡§Ü‡•§
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡•Å‡§ó‡§Ç‡§ß‡§ø‡§§ ‡§´‡•Ç‡§≤ ‡§™‡§ø‡§∞‡•ã‡§è ‡§ó‡§è‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§∂‡§ø‡§∑‡•ç‡§Ø ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ‡•§`,

`‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å 

‡§∂‡§∂‡§ø ‡§∞‡•ã‡§ú‡§º ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ú‡§æ‡§§‡§æ ‡§•‡§æ‡•§ 
‡§∑‡§ü‡•ç‡§ï‡•ã‡§£ ‡§ï‡•Ä ‡§∏‡§≠‡•Ä ‡§≠‡•Å‡§ú‡§æ‡§è‡§Å ‡§∏‡§Æ‡§æ‡§® ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ 
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø ‡§∏‡§Æ‡•É‡§¶‡•ç‡§ß ‡§π‡•à‡•§ 
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ‡•§ 
‡§ó‡§£‡§Å‡§ø‡§§ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§∞‡§≤ ‡§•‡§æ‡•§ 
‡§∂‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§∂‡§æ‡§Ç‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ 
‡§∑‡§∑‡•ç‡§† ‡§¶‡§ø‡§® ‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§ò‡•ã‡§∑‡§ø‡§§ ‡§π‡•Å‡§Ü‡•§

‡§∂‡§∂‡§ø ‡§∞‡•ã‡§ú‡§º ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ú‡§æ‡§§‡§æ ‡§•‡§æ‡•§
‡§∑‡§ü‡•ç‡§ï‡•ã‡§£ ‡§ï‡•Ä ‡§∏‡§≠‡•Ä ‡§≠‡•Å‡§ú‡§æ‡§è‡§Å ‡§∏‡§Æ‡§æ‡§® ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§‡§ø ‡§∏‡§Æ‡•É‡§¶‡•ç‡§ß ‡§π‡•à‡•§
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ‡•§
‡§ó‡§£‡§Å‡§ø‡§§ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§∞‡§≤ ‡§•‡§æ‡•§
‡§∂‡§æ‡§Æ ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§∂‡§æ‡§Ç‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
‡§∑‡§∑‡•ç‡§† ‡§¶‡§ø‡§® ‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§ò‡•ã‡§∑‡§ø‡§§ ‡§π‡•Å‡§Ü‡•§`,

`‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å 

‡§∂‡§∂‡§ø ‡§®‡•á ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ‡§à‡•§ 
‡§∑‡§∑‡•ç‡§† ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø ‡§Ü‡§ú ‡§™‡§¢‡§º‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§ 
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§´‡•Ç‡§≤ ‡§•‡•á‡•§ 
‡§¨‡§æ‡§≥‡§ï ‡§ñ‡•á‡§≤ ‡§Æ‡•á‡§Ç ‡§Æ‡§ó‡•ç‡§® ‡§•‡§æ‡•§ 
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ‡•§ 
‡§ó‡§£‡§Å‡§ø‡§§ ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§

‡§∂‡§∂‡§ø ‡§®‡•á ‡§ï‡§π‡§æ‡§®‡•Ä ‡§∏‡•Å‡§®‡§æ‡§à‡•§
‡§∑‡§∑‡•ç‡§† ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø ‡§Ü‡§ú ‡§™‡§¢‡§º‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§
‡§Æ‡§æ‡§≥‡§æ ‡§Æ‡•á‡§Ç ‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§´‡•Ç‡§≤ ‡§•‡•á‡•§
‡§¨‡§æ‡§≥‡§ï ‡§ñ‡•á‡§≤ ‡§Æ‡•á‡§Ç ‡§Æ‡§ó‡•ç‡§® ‡§•‡§æ‡•§
‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§®‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§∏‡§Æ‡§ù‡§æ‡§Ø‡§æ‡•§
‡§ó‡§£‡§Å‡§ø‡§§ ‡§ï‡§æ ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§`,

`‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å ‡§≥‡§∂‡§∑‡•§‡•ü ‡§£‡§Å 

‡§∂‡§∂‡§ø ‡§∂‡§æ‡§Ç‡§§ ‡§∏‡•ç‡§µ‡§≠‡§æ‡§µ ‡§ï‡§æ ‡§•‡§æ‡•§ 
‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§è‡§ï ‡§ú‡•ç‡§Ø‡§æ‡§Æ‡§ø‡§§‡•Ä‡§Ø ‡§Ü‡§ï‡•É‡§§‡§ø ‡§π‡•à‡•§ 
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§™‡•ç‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§π‡•à‡•§ 
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§™‡§æ‡§®‡•Ä ‡§™‡§ø‡§Ø‡§æ‡•§ 
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§∂‡§æ‡§Ç‡§§ ‡§•‡§æ‡•§

‡§∂‡§∂‡§ø ‡§∂‡§æ‡§Ç‡§§ ‡§∏‡•ç‡§µ‡§≠‡§æ‡§µ ‡§ï‡§æ ‡§•‡§æ‡•§
‡§∑‡§ü‡•ç‡§≠‡•Å‡§ú ‡§è‡§ï ‡§ú‡•ç‡§Ø‡§æ‡§Æ‡§ø‡§§‡•Ä‡§Ø ‡§Ü‡§ï‡•É‡§§‡§ø ‡§π‡•à‡•§
‡§Æ‡§æ‡§≥‡§µ‡§æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§™‡•ç‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§π‡•à‡•§
‡§¨‡§æ‡§≥‡§ï ‡§®‡•á ‡§™‡§æ‡§®‡•Ä ‡§™‡§ø‡§Ø‡§æ‡•§
‡§∂‡§æ‡§Æ ‡§ï‡•ã ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§∂‡§æ‡§Ç‡§§ ‡§•‡§æ‡•§`

];


// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  
    <h2><a href="/typing-speed-test/hindi/l7/">Typing test Speed Hindi Tradition -Lassion 7</a></h2>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Tutor - Paragraph Mode</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; text-align:center;}
    h1 { margin-bottom:10px; }
      #text {
      max-width:700px; 
      margin:20px auto; 
      font-size:30px; 
      line-height:1.6;
      text-align:left; 
      background:#fff; 
      padding:15px; 
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.1); 
      white-space:pre-wrap;
      height:3.2em;   /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§ä‡§Å‡§ö‡§æ‡§à */
      overflow:hidden; /* ‡§ï‡•á‡§µ‡§≤ 2 ‡§≤‡§æ‡§á‡§® ‡§¶‡§ø‡§ñ‡•á‡§Ç */
      transition: font-size 0.3s ease;
    }
 .controls {
      text-align:center;
      margin-top:10px;
    }

    .controls button {
      font-size:18px;
      padding:5px 10px;
      margin:0 5px;
      border:none;
      background:#007bff;
      color:#fff;
      border-radius:5px;
      cursor:pointer;
    }

    .controls button:hover {
      background:#0056b3;
    }

    .correct { font-weight: bold; color:green; }
    .incorrect { font-weight: bold;  color:red; }
    .active { background:yellow; padding:1px 2px; border-radius:3px; font-weight:bold; }
    #input {
      width:90%; max-width:700px; padding:10px; font-size:26px; margin-top:20px;
      border:2px solid #007bff; border-radius:6px; font-weight: bold;
    }
    #stats { margin-top:20px; font-size:18px; }
    #result { display:none; margin-top:25px; }
    table {
      margin:20px auto; border-collapse:collapse; width:400px; background:#fff;
      box-shadow:0 0 10px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden;
    }
    td { padding:12px 15px; border:1px solid #ddd; font-size:16px; }
    td:first-child { font-weight:bold; background:#f0f4ff; width:180px; text-align:left; }
    textarea { margin:auto; }
    #restartBtn {
      display:none; margin-top:15px; padding:10px 20px; font-size:16px;
      border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer;
    }

#popupForm {
  display: none; 
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.popup-content {
  background: white;
  padding: 20px;
  border-radius: 5px;
  width: 300px;
  text-align: center;
}

.popup-content h2 {
  margin: 0;
  padding: 10px 0;
}

.popup-content form {
  display: flex;
  flex-direction: column;
}

.popup-content input, .popup-content textarea {
  padding: 8px;
  margin: 10px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}


.close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 30px;
  cursor: pointer;
}

.close-btn:hover {
  color: red;
}
   .timebtn, .wpwbtn, .accbtn {
  padding: 8px 5px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
  transition: all 0.3s ease;
  margin: 5px;
}
/* ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∞‡§Ç‡§ó */
.timebtn {
  border:1px solid #ff9800; /* Orange */
  
}
.accbtn {
   border:1px solid #2196f3;
}

.wpwbtn {
  border:1px solid #4caf50;
}


.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  font-weight: bold;
}

.dropdown-content a:hover {background-color: #ff9800;}

.dropdown:hover .dropdown-content {display: block;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
.dark-mode {
  background:#222;
  color:#fff;
}

.dark-mode #text,
.dark-mode table,
.dark-mode .dropdown-content,
.dark-mode .popup-content {
  background-color: #333;
  color: white;
  border-color: #444;
}
.dark-mode td:first-child {
    color: black;
    width: 180px;
   
}

.dark-mode .correct { color: #4caf50; }
.dark-mode .incorrect { color: #f44336; }
.dark-mode .active { background: #ffff00; color:#000; }

.dark-mode textarea,
.dark-mode input,
.dark-mode button {
  background: #555;
  color: white;
}
#finishBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #e91e63;
  color: #fff;
  border: none;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.25);
  display: none;
  transition: all 0.3s ease;
  z-index: 100;
}
#finishBtn:hover {
  background: #c2185b;
  transform: scale(1.1);
}
#modeToggleBtn {
  background:#9c27b0;
}
.dark-mode #modeToggleBtn {
  background:#7b1fa2;
}
/* ‚úÖ Result Page Animation */
#result {
  display: none;
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
#result.show {
  display: block;
  opacity: 1;
  transform: translateY(0);
}
/* ‚úÖ CSS ‡§∏‡•á Show/Hide Transition */
#detailedReport {
  overflow: hidden;
  transition: all 0.5s ease;
  opacity: 1;
}
#detailedReport.hidden {
  opacity: 0;
  max-height: 0;
  pointer-events: none;
}
.halfwrong {
  font-weight: bold;
  color: orange;
}
  </style>
</head>
<body>

  <h1>Typing Speed Test -Gajab Tools </h1>


  <div id="stats">

    <button class="accbtn" id="openFormBtn">‚ûïAdd Name/Lassion</button>
    <div class="dropdown">
      
 <span class="timebtn">  ‚è≥ Time Left: <span id="time" style="color: #ff9800;">10:00</span>  </span>
  <div class="dropdown-content">
     <a href="#">01:00</a>
    <a href="#">02:00</a>
     <a href="#">03:00</a> 
    <a href="#">05:00</a>
      <a href="#">10:00</a>
    <a href="#">20:00</a>
     <a href="#">30:00</a>
      <a href="#">60:00</a>
  </div>
</div>
   <button onclick="toggleDarkMode()" class="wpwbtn">üåì Toggle Dark Mode</button>
   <button class="accbtn" id="modeToggleBtn" onclick="toggleMode()">üî§ Mode: Character</button>
   <button class="timebtn" id="backspaceToggleBtn" onclick="toggleBackspace()">‚å´ Backspace: ON</button>
    <span class="wpwbtn"> ‚å®Ô∏è WPM: <span id="wpm" style="color: #4caf50;">0</span>  </span> 
     <span class="accbtn">üéØ Accuracy: <span id="accuracy" style="color: #2196f3;">100</span>%  </span>
       <span class="wpwbtn">‚≠ê Best Score: <span id="bestScore" style="color:#ff9800;">0</span> WPM </span>
 <div class="controls">
   
    <button onclick="changeSize(-2)">-</button>
    <button onclick="resetSize()">‚ñ†</button>
     <button onclick="changeSize(2)">+</button>
     <!-- ‚úÖ ‡§®‡§Ø‡§æ ‡§¨‡§ü‡§® -->
 <button id="finishBtn" onclick="toggleTest()" data-title="Start / Stop Test">‚ñ∂</button>
  </div>
  </div>

  <!-- Pop-up form -->
  <div id="popupForm" class="popup-form">
    <div class="popup-content">
      <span id="closeBtn" class="close-btn">&times;</span>
      <h2>Add Your Name & Your Passage</h2>
   <div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Enter Your Name:</b></label>
  <input type="text" id="userName" placeholder="Your Name" style="padding:6px; width:200px; margin-left:10px;" />
  <button onclick="saveUserName()">üíæ Save Name</button>
  <!-- User Passage Input -->
<div style="margin:20px auto; max-width:700px; text-align:left;">
  <label><b>Paste Your Passage:</b></label><br>
  <textarea id="customPassage" rows="4" style="width:100%; margin-top:5px; padding:8px;" placeholder="Paste your text here..."></textarea><br>
  <button onclick="useCustomPassage()" >‚úÖ Use Your Passage </button> 
</div>
</div>
    </div>
  </div>

  <div id="text"></div>
 <div id="progressBar" style="width:90%; max-width:700px; height:8px; background:#ddd; margin:0px auto 0px auto; border-radius:4px;">
  <div id="progress" style="height:100%; width:100%; background:#ff9800; border-radius:4px;"></div>
</div>
  <textarea id="input" rows="1" placeholder="Start typing here..."></textarea>


  <div id="result"></div>
    <button id="restartBtn">üîÑ Try Again</button>

 <div id="historyTable" style="margin-top:40px;"></div>

<!-- üìà Chart Sections -->
<div style="max-width:700px;margin:50px auto;">
  <h3>üìà Best WPM (Last 30 Days)</h3>
  <canvas id="wpmChart" height="120"></canvas>
</div>

<div style="max-width:700px;margin:50px auto;">
  <h3>üïí All Tests (Last 24 Hours)</h3>
  <canvas id="recentChart" height="120"></canvas>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Unicode-safe Hindi grapheme utils ---
const _seg = (Intl && Intl.Segmenter)
  ? new Intl.Segmenter('hi', { granularity: 'grapheme' })
  : null;

function toGraphemes(str) {
  // NFC ‡§∏‡•á canonical normalize + ZWJ/ZWNJ ‡§π‡§ü‡§æ‡§è‡§Å
  const s = (str || '').normalize('NFC').replace(/[\u200C\u200D]/g, '');
  if (_seg) return Array.from(_seg.segment(s), x => x.segment);
  // Fallback: Array.from codepoints (‡§ï‡§Æ ‡§∏‡§π‡•Ä, ‡§™‡§∞ ‡§¨‡•á‡§π‡§§‡§∞ than split(""))
  return Array.from(s);
}
</script>

<script>
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape") {
      initTest(); // ESC to restart
    }
    if(e.ctrlKey && e.key === "Enter") {
      finishTest(); // Ctrl+Enter to finish test
    }
    if(e.key === "Tab") {
      e.preventDefault(); // prevent tab jump
      input.focus(); // focus on typing input
    }
  });
</script>

  <script>
    const defaultSize = 30; // px

    function changeSize(delta) {
      const text = document.getElementById("text");
      let current = parseInt(window.getComputedStyle(text).fontSize);
      let newSize = current + delta;
      if (newSize >= 12 && newSize <= 80) { // limit
        text.style.fontSize = newSize + "px";
      }
    }

    function resetSize() {
      const text = document.getElementById("text");
      text.style.fontSize = defaultSize + "px";
    }
  </script>
<script>
const lessons = [
`‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± 
‡§ì‡§Æ‡§ï‡§æ‡§∞‡•á‡§∂‡•ç‡§µ‡§∞ ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§•‡•Ä. ‡§ì‡§Æ‡§ï‡§æ‡§∞‡•á‡§∂‡•ç‡§µ‡§∞ ‡§Æ‡§Ç‡§¶‡§ø‡§∞ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§•‡•Ä. 
‡§õ‡§§ ‡§™‡§∞ ‡§∞‡§ñ‡•Ä ‡§õ‡§§‡§∞‡•Ä ‡§Ö‡§ö‡§æ‡§®‡§ï ‡§ó‡§ø‡§∞ ‡§ó‡§à. ‡§õ‡§§ ‡§™‡§∞ ‡§∞‡§ñ‡•Ä ‡§õ‡§§‡§∞‡•Ä ‡§Ö‡§ö‡§æ‡§®‡§ï ‡§ó‡§ø‡§∞ ‡§ó‡§à.
‡§•‡•ã‡§°‡§º‡§æ ‡§Ü‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§•‡§ï‡§æ‡§® ‡§¶‡•Ç‡§∞ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à. ‡§•‡•ã‡§°‡§º‡§æ ‡§Ü‡§∞‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§•‡§ï‡§æ‡§® ‡§¶‡•Ç‡§∞ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à.
‡§ñ‡•á‡§§ ‡§Æ‡•á‡§Ç ‡§Ö‡§Ç‡§ó‡•Ç‡§∞ ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•Å‡§à ‡§π‡•à. ‡§ñ‡•á‡§§ ‡§Æ‡•á‡§Ç ‡§Ö‡§Ç‡§ó‡•Ç‡§∞ ‡§ï‡•Ä ‡§´‡§∏‡§≤ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•Å‡§à ‡§π‡•à.
‡§´‡§≤ ‡§î‡§∞ ‡§¶‡•Ç‡§ß ‡§∏‡•á‡§π‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡§Ç. ‡§´‡§≤ ‡§î‡§∞ ‡§¶‡•Ç‡§ß ‡§∏‡•á‡§π‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à‡§Ç.`,

`‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± 
‡§±‡•ã‡§ú ‡§±‡•ã‡§ú ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó ‡§∏‡•Å‡§ß‡§∞‡§§‡•Ä ‡§π‡•à, ‡§±‡•ã‡§ú ‡§±‡•ã‡§ú ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó ‡§∏‡•Å‡§ß‡§∞‡§§‡•Ä ‡§π‡•à,
‡§•‡•ã‡§°‡§º‡§æ ‡§•‡•ã‡§°‡§º‡§æ ‡§∏‡•Ä‡§ñ‡§®‡§æ ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§æ‡§§‡§æ ‡§π‡•à. ‡§•‡•ã‡§°‡§º‡§æ ‡§•‡•ã‡§°‡§º‡§æ ‡§∏‡•Ä‡§ñ‡§®‡§æ ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§æ‡§§‡§æ ‡§π‡•à.
‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è. ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§Ø ‡§™‡§∞ ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è.
‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä ‡§∏‡•á ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§Ü ‡§∞‡§π‡•Ä ‡§π‡•à. ‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä ‡§∏‡•á ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§Ü ‡§∞‡§π‡•Ä ‡§π‡•à.
‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§∞‡§ñ‡•á‡§Ç. ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§∞‡§ñ‡•á‡§Ç.`,

`‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± 
‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à, ‡§≤‡•ã‡§Æ‡§°‡§º‡•Ä ‡§Ö‡§Ç‡§ó‡•Ç‡§∞ ‡§§‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡•Ä. ‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§π‡•à, ‡§≤‡•ã‡§Æ‡§°‡§º‡•Ä ‡§Ö‡§Ç‡§ó‡•Ç‡§∞ ‡§§‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡•Ä.
‡§õ‡•ã‡§ü‡§æ ‡§¨‡§ö‡•ç‡§ö‡§æ ‡§ñ‡§ø‡§≤‡•å‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡•ã‡§®‡•á ‡§≤‡§ó‡§æ. ‡§õ‡•ã‡§ü‡§æ ‡§¨‡§ö‡•ç‡§ö‡§æ ‡§ñ‡§ø‡§≤‡•å‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡•ã‡§®‡•á ‡§≤‡§ó‡§æ.
‡§•‡•ã‡§°‡§º‡•Ä ‡§Æ‡•á‡§π‡§®‡§§ ‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§´‡§≤ ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à. ‡§•‡•ã‡§°‡§º‡•Ä ‡§Æ‡•á‡§π‡§®‡§§ ‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§´‡§≤ ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à.
‡§ñ‡§æ‡§®‡§æ ‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§•‡•ã‡§°‡§º‡§æ ‡§´‡§≤ ‡§ñ‡§æ‡§®‡§æ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à. ‡§ñ‡§æ‡§®‡§æ ‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§•‡•ã‡§°‡§º‡§æ ‡§´‡§≤ ‡§ñ‡§æ‡§®‡§æ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à.
‡§ì‡§Æ ‡§ï‡§æ ‡§ú‡§æ‡§™ ‡§Æ‡§® ‡§ï‡•ã ‡§∂‡§æ‡§Ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à. ‡§ì‡§Æ ‡§ï‡§æ ‡§ú‡§æ‡§™ ‡§Æ‡§® ‡§ï‡•ã ‡§∂‡§æ‡§Ç‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à.`,

`‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± 
‡§õ‡§§‡§∞‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§Æ‡•á‡§Ç ‡§µ‡§∞‡§¶‡§æ‡§® ‡§∏‡•á ‡§ï‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§õ‡§§‡§∞‡•Ä ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§Æ‡•á‡§Ç ‡§µ‡§∞‡§¶‡§æ‡§® ‡§∏‡•á ‡§ï‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à,
‡§•‡§ï‡§æ‡§® ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§•‡•ã‡§°‡§º‡§æ ‡§Ü‡§∞‡§æ‡§Æ ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à. ‡§•‡§ï‡§æ‡§® ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§•‡•ã‡§°‡§º‡§æ ‡§Ü‡§∞‡§æ‡§Æ ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à.
‡§ñ‡•á‡§§ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§†‡•á‡§≤‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§≤ ‡§¨‡•á‡§ö ‡§∞‡§π‡§æ ‡§•‡§æ. ‡§ñ‡•á‡§§ ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§†‡•á‡§≤‡•á ‡§µ‡§æ‡§≤‡§æ ‡§´‡§≤ ‡§¨‡•á‡§ö ‡§∞‡§π‡§æ ‡§•‡§æ.
‡§ë‡§´‡§ø‡§∏ ‡§∏‡•á ‡§≤‡•å‡§ü‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§†‡§Ç‡§° ‡§¨‡§¢‡§º ‡§ó‡§à ‡§•‡•Ä. ‡§ë‡§´‡§ø‡§∏ ‡§∏‡•á ‡§≤‡•å‡§ü‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§†‡§Ç‡§° ‡§¨‡§¢‡§º ‡§ó‡§à ‡§•‡•Ä.
‡§±‡•ã‡§ú ‡§±‡•ã‡§ú ‡§∏‡§π‡•Ä ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è. ‡§±‡•ã‡§ú ‡§±‡•ã‡§ú ‡§∏‡§π‡•Ä ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è.`,

`‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§±  ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± ‡§ì‡§è‡§Ö‡§á‡§â‡§á ‡§ë‡§†‡§õ‡§•‡§ñ‡§±‡§´‡§± 
‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§•‡•ã‡§°‡§º‡§æ ‡§Ö‡§®‡•Å‡§∂‡§æ‡§∏‡§® ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à. ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§•‡•ã‡§°‡§º‡§æ ‡§Ö‡§®‡•Å‡§∂‡§æ‡§∏‡§® ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à.
‡§•‡•ã‡§°‡§º‡§æ ‡§¶‡•Ç‡§ß ‡§™‡•Ä‡§®‡§æ ‡§∏‡•á‡§π‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à. ‡§•‡•ã‡§°‡§º‡§æ ‡§¶‡•Ç‡§ß ‡§™‡•Ä‡§®‡§æ ‡§∏‡•á‡§π‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§π‡•à.
‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§•‡•Ä. ‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä ‡§ï‡•á ‡§¨‡§æ‡§π‡§∞ ‡§†‡§Ç‡§°‡•Ä ‡§π‡§µ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§•‡•Ä.
‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ó‡§≤‡§§‡•Ä ‡§® ‡§ï‡§∞‡•á‡§Ç. ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ó‡§≤‡§§‡•Ä ‡§® ‡§ï‡§∞‡•á‡§Ç.
‡§´‡§≤ ‡§ñ‡§∞‡•Ä‡§¶‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§§‡§æ‡§ú‡§ó‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç. ‡§´‡§≤ ‡§ñ‡§∞‡•Ä‡§¶‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§§‡§æ‡§ú‡§ó‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç.`
]


// üîπ Global Variables
let textToType, chars;   
let startTime, timer, started = false;
let timeLimit = 600;
let timeLeft = timeLimit;
let correctChars = 0, wrongChars = 0;
let backspaceCount = 0;  // ‚úÖ Backspace counter (global)

const textDiv = document.getElementById("text");
const input = document.getElementById("input");
const timeSpan = document.getElementById("time");
const wpmSpan = document.getElementById("wpm");
const accSpan = document.getElementById("accuracy");
const resultDiv = document.getElementById("result");
const restartBtn = document.getElementById("restartBtn");

// ‚è≥ Format Time
function formatTime(seconds) {
  let m = Math.floor(seconds / 60);
  let s = seconds % 60;
  return (m < 10 ? "0" + m : m) + ":" + (s < 10 ? "0" + s : s);
}

// üß© Initialize new test
function initTest() {
  textToType = lessons[Math.floor(Math.random() * lessons.length)];
  chars = toGraphemes(textToType);
  started = false;
  timeLeft = timeLimit;
  correctChars = 0;
  wrongChars = 0;
  backspaceCount = 0; // ‚úÖ Reset counter

  input.value = "";
  input.disabled = false;
  document.getElementById("stats").style.display = "block";
  document.getElementById("result").style.display = "none";
  restartBtn.style.display = "none";
  textDiv.style.display = "block";
  input.style.display = "block";
  renderText([]);
 timeSpan.textContent = formatTime(timeLimit);
  wpmSpan.textContent = 0;
  accSpan.textContent = 100;
  document.getElementById("finishBtn").style.display = "inline-block";
}

// üïê Update Stats Every Second
function updateStats() {
  if (timeLeft <= 0) {
    finishTest();
    return;
  }
  timeLeft--;
  timeSpan.textContent = formatTime(timeLeft);
  document.getElementById("progress").style.width = (timeLeft / timeLimit) * 100 + "%";

  let elapsed = (new Date() - startTime) / 1000;
  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;

  wpmSpan.textContent = wpm.toFixed(0);
  accSpan.textContent = accuracy.toFixed(0);
}

// üü° Render Text (Character or Word Mode)
function renderText() {
  const typedGraphemes = toGraphemes(input.value);

  if (typingMode === "word") {
    // üîπ Word Mode (‡§ú‡•à‡§∏‡§æ ‡§™‡§π‡§≤‡•á ‡§•‡§æ)
    const words = textToType.split(/\s+/);
    const typedWords = input.value.trim().split(/\s+/);
    const currentWordIndex = input.value.endsWith(" ")
      ? typedWords.length
      : typedWords.length - 1;

    textDiv.innerHTML = words
      .map((word, i) => {
        let cls = "";
        if (typedWords[i] == null) cls = "";
        else if (typedWords[i] === word) cls = "correct";
        else cls = "incorrect";
        return i === currentWordIndex
          ? `<span class="active">${word}</span>`
          : `<span class="${cls}">${word}</span>`;
      })
      .join(" ");
  } 
  else {
    // üî∏ Character Mode (updated ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic)
   // üî∏ Character Mode (fixed ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ logic + last-letter fix)
textDiv.innerHTML = chars.map((g, i) => {
  const typed = typedGraphemes[i];
  let cls = "";

  if (typed == null) {
    cls = "";
  } else {
    const t = typed.normalize("NFC");
    const target = g.normalize("NFC");

    const consonantRegex = /[\u0915-\u0939\u0958-\u095f\u0978-\u097f]/;
    const matraRegex     = /[\u093e-\u094c\u0962\u0963]/;

    const gCons  = (target.match(consonantRegex)?.[0]) || "";
    const gMatra = (target.match(matraRegex)?.[0])     || "";
    const tCons  = (t.match(consonantRegex)?.[0])      || "";
    const tMatra = (t.match(matraRegex)?.[0])          || "";

    const isConsonantTarget = !!gCons;
    const matraExpected = gMatra !== "";
    const matraOk = matraExpected ? (tMatra === gMatra) : (tMatra === "");

    // non-consonant (space, punctuation, independent vowels, newline) ‚Üí direct equality
    if (!isConsonantTarget) {
      cls = (t === target) ? "correct" : "incorrect";
    } else {
      const consCorrect = (tCons === gCons);
      if (consCorrect && matraOk) {
        cls = "correct";                 // ‚úÖ base + (expected) matra ‡§†‡•Ä‡§ï
      } else if (consCorrect && !matraOk) {
        // ‡§Æ‡§æ‡§§‡•ç‡§∞‡§æ expected ‡§•‡•Ä ‡§™‡§∞ ‡§Ö‡§≠‡•Ä ‡§∏‡§π‡•Ä/‡§™‡•Ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
        const nextTypedExists = !!typedGraphemes[i + 1];
        cls = nextTypedExists ? "incorrect" : "halfwrong"; // ‚è≥ ‡§Ö‡§≠‡•Ä incomplete ‡§§‡•ã orange, ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º ‡§ó‡§è ‡§§‡•ã red
      } else {
        cls = "incorrect";               // ‚ùå base ‡§π‡•Ä ‡§ó‡§≤‡§§
      }
    }
  }

  const displayChar = (g === "\n")
  ? "<span style='color:#999;'>‚Ü≤</span><br>"
  : g;
  return i === typedGraphemes.length
    ? `<span id="activeChar" class="active">${displayChar}</span>`
    : `<span class="${cls}">${displayChar}</span>`;
}).join("");

  }

  // ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§è‡§°‡§ú‡§∏‡•ç‡§ü
  const activeEl = document.querySelector(".active");
  if (activeEl) {
    let offset = activeEl.offsetTop - textDiv.offsetTop;
    textDiv.scrollTop = offset - 25;
  }
}



// üß† Typing Input Logic
input.addEventListener("input", (e) => {
  const val = e.target.value;
  const typedGraphemes = toGraphemes(val);

  if (!started && val.length > 0) {
    started = true;
    startTime = new Date();
    timer = setInterval(updateStats, 1000);
  }

  renderText();
  correctChars = 0;
  wrongChars = 0;

  if (typingMode === "character") {
    typedGraphemes.forEach((g, i) => {
      if (g === chars[i]) correctChars++;
      else wrongChars++;
    });
  } else {
    const typedWords = val.trim().split(/\s+/);
    const targetWords = textToType.trim().split(/\s+/);
    typedWords.forEach((word, i) => {
      if (word === targetWords[i]) correctChars += word.length + 1;
      else wrongChars += word.length + 1;
    });
  }

  // üîÅ Auto Repeat logic ‚Äî 50 words before ending
  const totalWords = textToType.trim().split(/\s+/).length;
  const typedWords = val.trim().split(/\s+/).length;

let repeatThreshold = Math.max(30, Math.floor(totalWords * 0.1)); // ‡§ï‡•Å‡§≤ ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ 10%, ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 30
if (totalWords - typedWords <= repeatThreshold) {
  textToType += "\n\n" + textToType;
  chars = toGraphemes(textToType);
  renderText();
}
});




// ‚úÖ Global Backspace Counter (works everywhere)
document.addEventListener("keydown", function (e) {
  if (e.key === "Backspace" && !e.repeat) {
    backspaceCount++;
  }
});

</script>

<script>
function finishTest(){
  clearInterval(timer);
  input.disabled = true;
  document.getElementById("finishBtn").style.display = "none";
  if (correctChars + wrongChars === 0) return;

  textDiv.style.display = "none";
  input.style.display = "none";
  document.getElementById("stats").style.display = "none";

  resultDiv.classList.remove("show");
  resultDiv.style.display = "block";
  setTimeout(() => resultDiv.classList.add("show"), 50);
  restartBtn.style.display = "inline-block";

  let elapsed = (new Date() - startTime) / 1000; // total seconds
  let hours = Math.floor(elapsed / 3600);
  let minutes = Math.floor((elapsed % 3600) / 60);
  let seconds = Math.floor(elapsed % 60);
  let formattedTime = 
      `${hours.toString().padStart(2, '0')}:` +
      `${minutes.toString().padStart(2, '0')}:` +
      `${seconds.toString().padStart(2, '0')}`; // ‚úÖ HH:MM:SS format

  let wpm = (correctChars / 5) / (elapsed / 60);
  let accuracy = (correctChars + wrongChars)
    ? (correctChars / (correctChars + wrongChars)) * 100
    : 100;
  let totalTyped = correctChars + wrongChars;

  updateBestScore(wpm.toFixed(0));

  resultDiv.innerHTML = `
    <h2>üìä Test Result</h2>
    <table>
      <tr><td>Typing Speed</td><td>${wpm.toFixed(0)} WPM</td></tr>
      <tr><td>Accuracy</td><td>${accuracy.toFixed(0)}%</td></tr>
      <tr><td>Time Taken</td><td>${formattedTime}</td></tr> <!-- ‚úÖ HH:MM:SS -->
      <tr><td>Total Typed Characters</td><td>${totalTyped}</td></tr>
      <tr><td>Correct Characters</td><td style="color:green;">${correctChars}</td></tr>
      <tr><td>Wrong Characters</td><td style="color:red;">${wrongChars}</td></tr>
      <tr><td>Correct Words</td><td style="color:green;">${Math.round(correctChars / 5)}</td></tr>
      <tr><td>Wrong Words</td><td style="color:red;">${Math.round(wrongChars / 5)}</td></tr>
      <tr><td>Backspace Used</td><td>${backspaceCount}</td></tr>
    </table>
  `;

  saveHistory({
    wpm: wpm.toFixed(0),
    accuracy: accuracy.toFixed(0),
    time: elapsed.toFixed(0),
    totalTyped,
    correct: correctChars,
    wrong: wrongChars,
    backspace: backspaceCount,
    date: new Date().toLocaleString()
  });

  renderHistory();
  document.getElementById("finishBtn").textContent = "‚ñ∂Ô∏è";
  testRunning = false;
}
</script>




<script>
// ‚úÖ Improved saveHistory(): ‡§Ö‡§¨ Backspace ‡§≠‡•Ä ‡§∏‡•á‡§µ ‡§π‡•ã‡§ó‡§æ
function saveHistory(entry){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  
  // ‚úÖ Words calculation
  entry.totalWords = Math.round(entry.totalTyped / 5);
  entry.correctWords = Math.round(entry.correct / 5);
  entry.wrongWords = Math.round(entry.wrong / 5);
  entry.backspace = entry.backspace || 0; // üîπ ensure backspace is saved

  // üèÜ Highest WPM logic
  let highest = 0;
  if (history.length > 0) {
    highest = Math.max(...history.map(h => parseInt(h.wpm)));
  }
  if (parseInt(entry.wpm) > highest) {
    localStorage.setItem("highestWpm", entry.wpm);
  }

  // ‚úÖ Protect highest WPM record
  let highestWpm = parseInt(localStorage.getItem("highestWpm") || 0);
  let highestEntry = history.find(h => parseInt(h.wpm) === highestWpm);

  // ‡§®‡§Ø‡§æ record ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
  history.push(entry);

  // ‚úÖ ‡§Ö‡§ó‡§∞ records 20 ‡§∏‡•á ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§π‡•à‡§Ç ‡§§‡•ã oldest delete ‡§ï‡§∞‡•á‡§Ç (highest ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞)
  if (history.length > 20) {
    let filtered = history.filter(h => parseInt(h.wpm) === highestWpm);
    let remaining = history.filter(h => parseInt(h.wpm) !== highestWpm);
    if (remaining.length > 19) remaining = remaining.slice(-19);
    history = [...filtered, ...remaining];
  }

  // ‚úÖ Save final list
  localStorage.setItem("typingHistory", JSON.stringify(history));
}
</script>

<script>
function downloadReport(){
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");

  if(history.length === 0){ 
    alert("No history!"); 
    return; 
  }

  if (history.length > 20) history = history.slice(-20);

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  let userName = localStorage.getItem("userName") || "Anonymous";

  // Group by date
  let grouped = {};
  history.forEach(h=>{
    let d = h.date.split(",")[0];
    if(!grouped[d]) grouped[d] = [];
    grouped[d].push(h);
  });
  let lastDate = Object.keys(grouped).sort().pop();
  let tests = grouped[lastDate];

  // Summary calculation
  let totalTest = tests.length;
  let timeSpent = tests.reduce((a,b)=>a+parseInt(b.time),0);
  let lowest = Math.min(...tests.map(t=>parseInt(t.wpm)));
  let highest = Math.max(...tests.map(t=>parseInt(t.wpm)));
  let avgSpeed = (tests.reduce((a,b)=>a+parseInt(b.wpm),0)/totalTest).toFixed(0);
  let totalTyped = tests.reduce((a,b)=>a+b.totalWords,0);
  let totalCorrect = tests.reduce((a,b)=>a+b.correctWords,0);
  let avgAcc = (tests.reduce((a,b)=>a+parseInt(b.accuracy),0)/totalTest).toFixed(1);
  let totalBackspace = tests.reduce((a,b)=>a+(parseInt(b.backspace)||0),0); // ‚úÖ Added
  let deletedCount = deleted[lastDate] || 0;

  // ===== Header =====
  doc.setFontSize(16);
  doc.text("üìú Typing Report (Last 20 Tests)", 14, 20);
  doc.setFontSize(12);
  doc.text("Name: " + userName + ", Report Date: " + new Date().toLocaleString(), 14, 30);

  // ===== Summary =====
  let y = 40;
  doc.setFontSize(13);
  doc.text("Summary ("+lastDate+")", 14, y);
  y += 8;
  doc.setFontSize(11);
  doc.text("Total Test: " + totalTest, 14, y); y+=6;
  doc.text("Time Spent: " + Math.round(timeSpent/60)+" m", 14, y); y+=6;
  doc.text("Lowest Speed: " + lowest, 14, y); y+=6;
  doc.text("Highest Speed: " + highest, 14, y); y+=6;
  doc.text("Avg Speed: " + avgSpeed, 14, y); y+=6;
  doc.text("Total Words: " + totalTyped, 14, y); y+=6;
  doc.text("Correct Words: " + totalCorrect, 14, y); y+=6;
  doc.text("Avg Accuracy: " + avgAcc+"%", 14, y); y+=6;
  doc.text("Total Backspace: " + totalBackspace, 14, y); y+=6; // ‚úÖ New line
  doc.text("Deleted Test: " + deletedCount, 14, y); y+=10;

  // ===== Details Table =====
  doc.setFontSize(13);
  doc.text("üìÖ Detailed Report", 14, y);
  y+=8;
  doc.setFontSize(11);
  doc.text("Time", 14, y);
  doc.text("WPM", 60, y);
  doc.text("Acc.", 90, y);
  doc.text("Correct", 120, y);
  doc.text("Wrong", 150, y);
  doc.text("Words", 180, y);
  doc.text("Back", 205, y);
  y+=6;

  tests.forEach(h=>{
    doc.text(h.date, 14, y);
    doc.text(h.wpm.toString(), 60, y);
    doc.text(h.accuracy+"%", 90, y);
    doc.text(h.correctWords.toString(), 120, y);
    doc.text(h.wrongWords.toString(), 150, y);
    doc.text(h.totalWords.toString(), 180, y);
    doc.text((h.backspace||0).toString(), 205, y);
    y+=6;
    if(y > 280){
      doc.addPage();
      y=20;
    }
  });

  doc.save(userName.replace(/\s+/g,"_")+"_report.pdf");
}
</script>



<script>
function renderHistory() {
  const container = document.getElementById("historyTable");
  let history = JSON.parse(localStorage.getItem("typingHistory") || "[]");
  let deleted = JSON.parse(localStorage.getItem("deletedCount") || "{}");
  if (!container) return;

  if (history.length === 0) {
    container.innerHTML = "<p>No history yet.</p>
  

  </main>
  <footer>
   <p>Copyright 2025. All rights reserved.</p>
  </footer>
</body>
</html>
